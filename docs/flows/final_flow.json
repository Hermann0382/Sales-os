{
  "artifact_type": "flow",
  "status": "complete",
  "validation": "passed",
  "approval_required": true,
  "approvers": [
    "Cynthia",
    "Hassan"
  ],
  "next_phase": "erd_design",
  "data": {
    "project_name": "CallOS",
    "version": "1.0.0",
    "created_at": "2026-01-08T14:30:00Z",
    "user_flows": [
      {
        "id": "FLOW-001",
        "name": "Start New Call Session",
        "description": "Sales agent initiates a new call session by selecting a prospect and completing the mandatory pre-call checklist before joining the call.",
        "feature_id": "FR-004",
        "story_ids": [
          "ST-018"
        ],
        "actor": "user",
        "trigger": "Agent selects 'New Call' from dashboard or clicks scheduled call in calendar",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Select or confirm prospect for the call",
            "actor": "user",
            "inputs": [
              "prospect_id",
              "ghl_contact_reference"
            ],
            "outputs": [
              "prospect_data_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "System displays pre-call checklist with prospect qualification data",
            "actor": "system",
            "inputs": [
              "prospect_id"
            ],
            "outputs": [
              "checklist_items",
              "qualification_form_data"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Verify qualification form has been reviewed",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "checklist_item_checked"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Confirm client count is 500 or more",
            "actor": "user",
            "inputs": [
              "client_count"
            ],
            "outputs": [
              "client_count_confirmed",
              "coaching_eligible_flag"
            ],
            "conditions": [
              {
                "condition": "client_count < 500",
                "outcome": "coaching_pitch_blocked"
              }
            ],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Confirm business type (financial advisor/broker)",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "business_type_confirmed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Note revenue range",
            "actor": "user",
            "inputs": [
              "revenue_range"
            ],
            "outputs": [
              "revenue_range_noted"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Identify main pain point",
            "actor": "user",
            "inputs": [
              "main_pain"
            ],
            "outputs": [
              "main_pain_identified"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Note tool stack",
            "actor": "user",
            "inputs": [
              "current_tools"
            ],
            "outputs": [
              "tool_stack_noted"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Confirm ROI tool is ready",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "roi_tool_ready"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "Confirm time block is clear",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "time_block_confirmed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "Paste Zoom link to activate recording",
            "actor": "user",
            "inputs": [
              "zoom_link"
            ],
            "outputs": [
              "recording_session_initialized"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "System validates all checklist items are complete",
            "actor": "system",
            "inputs": [
              "all_checklist_items"
            ],
            "outputs": [
              "checklist_validation_result"
            ],
            "conditions": [
              {
                "condition": "any_item_unchecked",
                "outcome": "block_call_start"
              }
            ],
            "next_steps": [
              "STEP-013"
            ]
          },
          {
            "id": "STEP-013",
            "sequence": 13,
            "action": "Create CallSession record and proceed to M1",
            "actor": "system",
            "inputs": [
              "prospect_id",
              "agent_id",
              "zoom_link",
              "checklist_data"
            ],
            "outputs": [
              "call_session_id",
              "call_status_active"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "All 8 pre-call checklist items verified",
          "Qualification status (500+ clients) confirmed",
          "Recording activated via Zoom link",
          "CallSession created with status 'active'"
        ],
        "error_handling": [
          {
            "error": "Client count below 500",
            "response": "System flags call as 'advisory only', blocks coaching pitch flow"
          },
          {
            "error": "Checklist incomplete",
            "response": "Start Call button disabled, missing items highlighted"
          },
          {
            "error": "Zoom link invalid",
            "response": "Display error, allow retry with correct link"
          }
        ]
      },
      {
        "id": "FLOW-002",
        "name": "Execute M1 Context and Frame",
        "description": "Sales agent executes the first milestone to establish shared understanding of call scope, setting expectations that this is a diagnostic, not a pitch.",
        "feature_id": "FR-002",
        "story_ids": [
          "ST-003"
        ],
        "actor": "user",
        "trigger": "Call session started, agent on M1 milestone",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "System displays M1 milestone panel with objective and time indicator (5 min)",
            "actor": "system",
            "inputs": [
              "call_session_id",
              "milestone_id"
            ],
            "outputs": [
              "milestone_ui_rendered",
              "timer_started"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "Agent states the reason for the call (diagnostic framing)",
            "actor": "user",
            "inputs": [
              "reason_for_call_text"
            ],
            "outputs": [
              "reason_captured"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Agent follows script guidance for 3 possible outcomes",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "script_followed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Confirm expectation alignment with prospect",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "expectation_confirmed_checkbox"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Track prospect relaxation signal (optional observation)",
            "actor": "user",
            "inputs": [
              "relaxation_signal_observed"
            ],
            "outputs": [
              "relaxation_noted"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Agent adds notes if needed",
            "actor": "user",
            "inputs": [
              "milestone_notes"
            ],
            "outputs": [
              "notes_saved"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "System validates required items (reason + expectation confirmation)",
            "actor": "system",
            "inputs": [
              "reason_for_call",
              "expectation_confirmed"
            ],
            "outputs": [
              "milestone_validation_result"
            ],
            "conditions": [
              {
                "condition": "strict_mode AND required_items_incomplete",
                "outcome": "block_progression"
              },
              {
                "condition": "flexible_mode AND required_items_incomplete",
                "outcome": "allow_with_override_logging"
              }
            ],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Agent marks M1 complete and proceeds to M2",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "milestone_status_complete",
              "next_milestone_activated"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "Reason for call captured in text field",
          "Expectation confirmed checkbox checked",
          "M1 marked complete within approximately 5 minutes",
          "Prospect understands this is diagnostic, not pitch"
        ],
        "error_handling": [
          {
            "error": "Required fields not completed in strict mode",
            "response": "Block progression, highlight missing items"
          },
          {
            "error": "Objection raised during M1",
            "response": "Trigger objection subflow, return to M1 after resolution"
          }
        ]
      },
      {
        "id": "FLOW-003",
        "name": "Execute M2 Current State Mapping",
        "description": "Sales agent maps the prospect's operational reality to expose fragility without judgment. Longest milestone at 15-20 minutes.",
        "feature_id": "FR-002",
        "story_ids": [
          "ST-004"
        ],
        "actor": "user",
        "trigger": "M1 completed, agent proceeds to M2",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "System displays M2 milestone panel with objective and time indicator (15-20 min)",
            "actor": "system",
            "inputs": [
              "call_session_id",
              "milestone_id"
            ],
            "outputs": [
              "milestone_ui_rendered",
              "timer_started"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "Capture client count (numeric field)",
            "actor": "user",
            "inputs": [
              "client_count_number"
            ],
            "outputs": [
              "client_count_recorded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Assess revenue volatility (1-5 scale)",
            "actor": "user",
            "inputs": [
              "revenue_volatility_rating"
            ],
            "outputs": [
              "volatility_recorded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Select main pain points (multi-select: Storno/chaos/instability)",
            "actor": "user",
            "inputs": [
              "main_pain_selections"
            ],
            "outputs": [
              "pain_points_recorded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Cover client handling patterns",
            "actor": "user",
            "inputs": [
              "client_handling_notes"
            ],
            "outputs": [
              "client_handling_covered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Cover revenue stability discussion",
            "actor": "user",
            "inputs": [
              "revenue_stability_notes"
            ],
            "outputs": [
              "revenue_stability_covered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Cover operations discussion",
            "actor": "user",
            "inputs": [
              "operations_notes"
            ],
            "outputs": [
              "operations_covered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Cover psychological load discussion",
            "actor": "user",
            "inputs": [
              "psychological_load_notes"
            ],
            "outputs": [
              "psychological_load_covered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "System generates summary for agent to verbalize back",
            "actor": "system",
            "inputs": [
              "all_m2_data"
            ],
            "outputs": [
              "current_state_summary"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "Agent verbalizes summary back to prospect",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "summary_delivered_checkbox"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "Add additional notes if needed",
            "actor": "user",
            "inputs": [
              "milestone_notes"
            ],
            "outputs": [
              "notes_saved"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "System validates required coverage areas",
            "actor": "system",
            "inputs": [
              "client_count",
              "revenue_volatility",
              "main_pain",
              "coverage_checklist"
            ],
            "outputs": [
              "milestone_validation_result"
            ],
            "conditions": [
              {
                "condition": "required_fields_incomplete",
                "outcome": "block_or_warn_based_on_mode"
              }
            ],
            "next_steps": [
              "STEP-013"
            ]
          },
          {
            "id": "STEP-013",
            "sequence": 13,
            "action": "Agent marks M2 complete and proceeds to M3",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "milestone_status_complete",
              "next_milestone_activated"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "Client count captured numerically",
          "Revenue volatility rated 1-5",
          "Main pain points selected from predefined options",
          "All 4 coverage areas discussed (client handling, revenue, ops, psychological)",
          "Summary verbalized back to prospect",
          "M2 complete within 15-20 minutes"
        ],
        "error_handling": [
          {
            "error": "Objection raised during mapping",
            "response": "Trigger objection subflow, return to M2 after resolution"
          },
          {
            "error": "Coverage area missed",
            "response": "Highlight uncovered areas, require completion or override with reason"
          }
        ]
      },
      {
        "id": "FLOW-004",
        "name": "Execute M3 Outcome Vision",
        "description": "Sales agent captures the prospect's desired future state and understands what 'working' looks like for them, without hype or fantasy language.",
        "feature_id": "FR-002",
        "story_ids": [
          "ST-005"
        ],
        "actor": "user",
        "trigger": "M2 completed, agent proceeds to M3",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "System displays M3 milestone panel with objective",
            "actor": "system",
            "inputs": [
              "call_session_id",
              "milestone_id"
            ],
            "outputs": [
              "milestone_ui_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "Capture desired outcome (text field)",
            "actor": "user",
            "inputs": [
              "desired_outcome_text"
            ],
            "outputs": [
              "desired_outcome_recorded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Capture 12-month vision",
            "actor": "user",
            "inputs": [
              "twelve_month_vision"
            ],
            "outputs": [
              "vision_recorded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Capture cost of inaction (text field)",
            "actor": "user",
            "inputs": [
              "cost_of_inaction_text"
            ],
            "outputs": [
              "cost_of_inaction_recorded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "System provides guidance to avoid hype/fantasy language",
            "actor": "system",
            "inputs": [],
            "outputs": [
              "language_guidance_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Agent adds notes if needed",
            "actor": "user",
            "inputs": [
              "milestone_notes"
            ],
            "outputs": [
              "notes_saved"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "System validates required fields",
            "actor": "system",
            "inputs": [
              "desired_outcome",
              "cost_of_inaction"
            ],
            "outputs": [
              "milestone_validation_result"
            ],
            "conditions": [
              {
                "condition": "required_fields_incomplete",
                "outcome": "block_or_warn_based_on_mode"
              }
            ],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Agent marks M3 complete and proceeds to M4",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "milestone_status_complete",
              "next_milestone_activated"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "Desired outcome captured in text",
          "12-month vision documented",
          "Cost of inaction articulated",
          "No hype or fantasy language used",
          "M3 marked complete"
        ],
        "error_handling": [
          {
            "error": "Prospect unable to articulate vision",
            "response": "Agent uses prompting questions, captures as much as possible"
          },
          {
            "error": "Objection raised",
            "response": "Trigger objection subflow, return to M3 after resolution"
          }
        ]
      },
      {
        "id": "FLOW-005",
        "name": "Execute M4 System Reality Check",
        "description": "Sales agent reveals the hidden cost of manual implementation, helping the prospect understand the 'second job' effect of DIY approaches.",
        "feature_id": "FR-002",
        "story_ids": [
          "ST-006"
        ],
        "actor": "user",
        "trigger": "M3 completed, agent proceeds to M4",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "System displays M4 milestone panel with objective",
            "actor": "system",
            "inputs": [
              "call_session_id",
              "milestone_id"
            ],
            "outputs": [
              "milestone_ui_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "Cover time required for manual implementation",
            "actor": "user",
            "inputs": [
              "time_required_discussion"
            ],
            "outputs": [
              "time_required_covered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Cover management overhead implications",
            "actor": "user",
            "inputs": [
              "management_overhead_discussion"
            ],
            "outputs": [
              "management_overhead_covered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Cover error probability in DIY approach",
            "actor": "user",
            "inputs": [
              "error_probability_discussion"
            ],
            "outputs": [
              "error_probability_covered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Cover burnout risk of manual work",
            "actor": "user",
            "inputs": [
              "burnout_risk_discussion"
            ],
            "outputs": [
              "burnout_risk_covered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Confirm prospect understands implementation effort",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "understands_effort_checkbox"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Confirm prospect acknowledges manual workload risk",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "acknowledges_risk_checkbox"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Access key framing guidance if needed",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "framing_guidance_accessed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Agent adds notes if needed",
            "actor": "user",
            "inputs": [
              "milestone_notes"
            ],
            "outputs": [
              "notes_saved"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "System validates confirmations",
            "actor": "system",
            "inputs": [
              "understands_effort",
              "acknowledges_risk"
            ],
            "outputs": [
              "milestone_validation_result"
            ],
            "conditions": [
              {
                "condition": "confirmations_incomplete",
                "outcome": "block_or_warn_based_on_mode"
              }
            ],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "Agent marks M4 complete and proceeds to M5",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "milestone_status_complete",
              "next_milestone_activated"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "All 4 coverage areas discussed (time, overhead, errors, burnout)",
          "Prospect confirms understanding of implementation effort",
          "Prospect acknowledges manual workload risk",
          "M4 marked complete"
        ],
        "error_handling": [
          {
            "error": "Prospect pushback on reality check",
            "response": "May trigger objection subflow if significant resistance"
          },
          {
            "error": "Confirmations not obtained",
            "response": "Cannot proceed in strict mode; flexible mode logs override"
          }
        ]
      },
      {
        "id": "FLOW-006",
        "name": "Execute M5 Solution Mapping",
        "description": "Sales agent presents the LeadTunnel system, helping the prospect see leverage versus manual execution through CRM, pipelines, and automations.",
        "feature_id": "FR-002",
        "story_ids": [
          "ST-007"
        ],
        "actor": "user",
        "trigger": "M4 completed, agent proceeds to M5",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "System displays M5 milestone panel with objective",
            "actor": "system",
            "inputs": [
              "call_session_id",
              "milestone_id"
            ],
            "outputs": [
              "milestone_ui_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "Present CRM capabilities and integration",
            "actor": "user",
            "inputs": [
              "crm_presentation_notes"
            ],
            "outputs": [
              "crm_covered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Present pipeline automation features",
            "actor": "user",
            "inputs": [
              "pipeline_presentation_notes"
            ],
            "outputs": [
              "pipelines_covered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Present automation capabilities",
            "actor": "user",
            "inputs": [
              "automation_presentation_notes"
            ],
            "outputs": [
              "automations_covered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Frame as one system versus tool chaos",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "framing_delivered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Confirm prospect sees system leverage",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "sees_leverage_checkbox"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Confirm prospect understands scope",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "understands_scope_checkbox"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Agent adds notes if needed",
            "actor": "user",
            "inputs": [
              "milestone_notes"
            ],
            "outputs": [
              "notes_saved"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "System validates confirmations",
            "actor": "system",
            "inputs": [
              "sees_leverage",
              "understands_scope"
            ],
            "outputs": [
              "milestone_validation_result"
            ],
            "conditions": [
              {
                "condition": "confirmations_incomplete",
                "outcome": "block_or_warn_based_on_mode"
              }
            ],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "Agent marks M5 complete and proceeds to M6",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "milestone_status_complete",
              "next_milestone_activated"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "CRM, pipelines, and automations presented",
          "One system vs tool chaos message delivered",
          "Prospect confirms seeing system leverage",
          "Prospect confirms understanding scope",
          "M5 marked complete"
        ],
        "error_handling": [
          {
            "error": "Prospect does not see leverage",
            "response": "May need to revisit M4 reality check or trigger objection flow"
          },
          {
            "error": "Scope confusion",
            "response": "Clarify before proceeding, do not oversell"
          }
        ]
      },
      {
        "id": "FLOW-007",
        "name": "Execute M6 Offer Presentation",
        "description": "Sales agent presents the coaching infrastructure investment with structural framing, not emotional selling. Price stated once, then silence.",
        "feature_id": "FR-002",
        "story_ids": [
          "ST-008"
        ],
        "actor": "user",
        "trigger": "M5 completed, qualification gate passed, agent proceeds to M6",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "System checks qualification gate (500+ clients)",
            "actor": "system",
            "inputs": [
              "client_count",
              "qualification_flags"
            ],
            "outputs": [
              "qualification_gate_result"
            ],
            "conditions": [
              {
                "condition": "client_count < 500",
                "outcome": "block_m6_advisory_only"
              }
            ],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "System displays M6 milestone panel with objective",
            "actor": "system",
            "inputs": [
              "call_session_id",
              "milestone_id"
            ],
            "outputs": [
              "milestone_ui_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Frame as 12-month infrastructure install",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "framing_delivered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "System displays price (auto-populated)",
            "actor": "system",
            "inputs": [
              "product_config"
            ],
            "outputs": [
              "price_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Agent states price once and stops talking",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "price_stated_checkbox"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "System displays silence guidance (do not fill silence)",
            "actor": "system",
            "inputs": [],
            "outputs": [
              "silence_guidance_shown"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Wait for prospect response",
            "actor": "user",
            "inputs": [
              "prospect_initial_reaction"
            ],
            "outputs": [
              "reaction_noted"
            ],
            "conditions": [
              {
                "condition": "objection_raised",
                "outcome": "trigger_objection_subflow"
              }
            ],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Select payment plan if proceeding",
            "actor": "user",
            "inputs": [
              "payment_plan_selection"
            ],
            "outputs": [
              "payment_plan_recorded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Re-anchor ROI if needed (use ROI tool)",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "roi_reanchored"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "Agent adds notes if needed",
            "actor": "user",
            "inputs": [
              "milestone_notes"
            ],
            "outputs": [
              "notes_saved"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "Agent marks M6 complete and proceeds to M7",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "milestone_status_complete",
              "next_milestone_activated"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "Qualification gate passed before M6",
          "12-month infrastructure framing delivered",
          "Price stated exactly once",
          "Agent maintained silence after price",
          "Payment plan selected if applicable",
          "M6 marked complete"
        ],
        "error_handling": [
          {
            "error": "Qualification gate failed",
            "response": "Block M6, mark call as advisory only"
          },
          {
            "error": "Price objection raised",
            "response": "Trigger FLOW-009 Price Objection Subflow"
          },
          {
            "error": "Agent fills silence prematurely",
            "response": "Guidance reminder displayed, logged for coaching"
          }
        ]
      },
      {
        "id": "FLOW-008",
        "name": "Execute M7 Decision Point",
        "description": "Sales agent requests an explicit decision from the prospect. Every call ends with a clean outcome: Proceed, Pause, or Decline.",
        "feature_id": "FR-002",
        "story_ids": [
          "ST-009"
        ],
        "actor": "user",
        "trigger": "M6 completed, agent proceeds to M7",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "System displays M7 milestone panel with objective",
            "actor": "system",
            "inputs": [
              "call_session_id",
              "milestone_id"
            ],
            "outputs": [
              "milestone_ui_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "Agent requests explicit decision",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "decision_requested"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "System displays silence guidance (do not fill silence)",
            "actor": "system",
            "inputs": [],
            "outputs": [
              "silence_guidance_shown"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Wait for prospect decision",
            "actor": "user",
            "inputs": [
              "prospect_response"
            ],
            "outputs": [
              "response_captured"
            ],
            "conditions": [
              {
                "condition": "objection_raised",
                "outcome": "trigger_objection_subflow"
              },
              {
                "condition": "clarification_question_asked",
                "outcome": "allow_clarification_only"
              }
            ],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Handle clarification questions only (no selling)",
            "actor": "user",
            "inputs": [
              "clarification_response"
            ],
            "outputs": [
              "clarification_provided"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Record forced choice outcome",
            "actor": "user",
            "inputs": [
              "decision_outcome"
            ],
            "outputs": [
              "proceed_or_pause_or_decline"
            ],
            "conditions": [
              {
                "condition": "outcome == proceed",
                "outcome": "route_to_coaching_onboarding"
              },
              {
                "condition": "outcome == pause",
                "outcome": "route_to_follow_up_scheduling"
              },
              {
                "condition": "outcome == decline",
                "outcome": "route_to_disqualification"
              }
            ],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Agent adds final notes",
            "actor": "user",
            "inputs": [
              "milestone_notes"
            ],
            "outputs": [
              "notes_saved"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Agent marks M7 complete",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "milestone_status_complete"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Proceed to call outcome classification (FLOW-015)",
            "actor": "system",
            "inputs": [
              "decision_outcome"
            ],
            "outputs": [
              "route_to_outcome_flow"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "Explicit decision requested",
          "Agent maintained silence until prospect responded",
          "Only clarification questions answered (no selling)",
          "Forced choice recorded: Proceed, Pause, or Decline",
          "M7 marked complete",
          "Call routed to outcome classification"
        ],
        "error_handling": [
          {
            "error": "Prospect avoids decision",
            "response": "May trigger 'Need to Think' objection subflow"
          },
          {
            "error": "Agent attempts to persuade",
            "response": "Guardrails block persuasion scripts, logged for coaching"
          },
          {
            "error": "No clear outcome",
            "response": "Cannot complete M7 without forced choice selection"
          }
        ]
      },
      {
        "id": "FLOW-009",
        "name": "Trigger Price Objection Subflow",
        "description": "Diagnostic subflow for price objections to identify value mismatch, cashflow concerns, or risk perception without arguing.",
        "feature_id": "FR-003",
        "story_ids": [
          "ST-010",
          "ST-011",
          "ST-012"
        ],
        "actor": "user",
        "trigger": "Prospect raises price-related concern at any milestone",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Agent selects 'Price' from objection selector",
            "actor": "user",
            "inputs": [
              "objection_type_selection"
            ],
            "outputs": [
              "price_objection_activated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "System displays price objection diagnostic panel",
            "actor": "system",
            "inputs": [
              "objection_id"
            ],
            "outputs": [
              "diagnostic_panel_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Ask Step 1: 'Compared to what?' (neutral, wait for answer)",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "question_asked_checkbox"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Wait for prospect response in silence",
            "actor": "user",
            "inputs": [
              "prospect_comparison_response"
            ],
            "outputs": [
              "comparison_captured"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Step 2: Classify the comparison",
            "actor": "user",
            "inputs": [
              "comparison_classification"
            ],
            "outputs": [
              "classification_recorded"
            ],
            "conditions": [
              {
                "condition": "classification == software",
                "outcome": "record_software_comparison"
              },
              {
                "condition": "classification == coaching",
                "outcome": "record_coaching_comparison"
              },
              {
                "condition": "classification == income",
                "outcome": "record_income_comparison"
              },
              {
                "condition": "classification == fear",
                "outcome": "record_fear_based"
              }
            ],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Step 3: Structural check - ask 6-month payback question",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "structural_question_asked"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Capture prospect response to payback question",
            "actor": "user",
            "inputs": [
              "payback_response"
            ],
            "outputs": [
              "payback_response_recorded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Agent adds diagnostic notes",
            "actor": "user",
            "inputs": [
              "objection_notes"
            ],
            "outputs": [
              "notes_saved"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Select forced outcome (cannot proceed without)",
            "actor": "user",
            "inputs": [
              "objection_outcome"
            ],
            "outputs": [
              "outcome_recorded"
            ],
            "conditions": [
              {
                "condition": "outcome == resolved",
                "outcome": "return_to_milestone"
              },
              {
                "condition": "outcome == deferred",
                "outcome": "flag_for_follow_up"
              },
              {
                "condition": "outcome == disqualified",
                "outcome": "route_to_disqualification"
              }
            ],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "System records ObjectionResponse and routes accordingly",
            "actor": "system",
            "inputs": [
              "call_session_id",
              "objection_id",
              "milestone_id",
              "outcome",
              "notes"
            ],
            "outputs": [
              "objection_response_saved",
              "routing_determined"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "'Compared to what?' asked neutrally",
          "Comparison classified (software/coaching/income/fear)",
          "6-month payback structural question asked",
          "Forced outcome selected: Resolved, Deferred, or Disqualified",
          "ObjectionResponse recorded with all data"
        ],
        "error_handling": [
          {
            "error": "Agent argues with price concern",
            "response": "Guardrails prevent rebuttal scripts, only diagnostic questions available"
          },
          {
            "error": "No outcome selected",
            "response": "Cannot close objection panel without forced outcome"
          }
        ]
      },
      {
        "id": "FLOW-010",
        "name": "Trigger Timing Objection Subflow",
        "description": "Diagnostic subflow for timing objections to understand real constraints versus avoidance behavior.",
        "feature_id": "FR-003",
        "story_ids": [
          "ST-010",
          "ST-011",
          "ST-013"
        ],
        "actor": "user",
        "trigger": "Prospect raises timing-related concern at any milestone",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Agent selects 'Timing' from objection selector",
            "actor": "user",
            "inputs": [
              "objection_type_selection"
            ],
            "outputs": [
              "timing_objection_activated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "System displays timing objection diagnostic panel",
            "actor": "system",
            "inputs": [
              "objection_id"
            ],
            "outputs": [
              "diagnostic_panel_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Ask Step 1: 'What would need to change?'",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "question_asked_checkbox"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Capture prospect response",
            "actor": "user",
            "inputs": [
              "change_condition_response"
            ],
            "outputs": [
              "condition_captured"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Step 2: Identify timing type",
            "actor": "user",
            "inputs": [
              "timing_type_classification"
            ],
            "outputs": [
              "type_recorded"
            ],
            "conditions": [
              {
                "condition": "type == cash",
                "outcome": "record_cash_constraint"
              },
              {
                "condition": "type == capacity",
                "outcome": "record_capacity_constraint"
              },
              {
                "condition": "type == emotional",
                "outcome": "record_emotional_constraint"
              },
              {
                "condition": "type == avoidance",
                "outcome": "record_avoidance_pattern"
              }
            ],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Step 3: Ask future projection question",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "future_question_asked"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Capture future projection response",
            "actor": "user",
            "inputs": [
              "future_projection_response"
            ],
            "outputs": [
              "projection_captured"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Step 4: Delay cost acknowledgment question",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "delay_cost_question_asked"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Capture delay cost acknowledgment",
            "actor": "user",
            "inputs": [
              "delay_cost_response"
            ],
            "outputs": [
              "delay_cost_captured"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "Agent adds diagnostic notes",
            "actor": "user",
            "inputs": [
              "objection_notes"
            ],
            "outputs": [
              "notes_saved"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "Select forced outcome",
            "actor": "user",
            "inputs": [
              "objection_outcome"
            ],
            "outputs": [
              "outcome_recorded"
            ],
            "conditions": [
              {
                "condition": "outcome == resolved",
                "outcome": "return_to_milestone"
              },
              {
                "condition": "outcome == deferred",
                "outcome": "flag_for_follow_up"
              },
              {
                "condition": "outcome == disqualified",
                "outcome": "route_to_disqualification"
              }
            ],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "System records ObjectionResponse and routes accordingly",
            "actor": "system",
            "inputs": [
              "call_session_id",
              "objection_id",
              "milestone_id",
              "outcome",
              "notes"
            ],
            "outputs": [
              "objection_response_saved",
              "routing_determined"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "'What would need to change?' asked",
          "Timing type classified (cash/capacity/emotional/avoidance)",
          "Future projection explored",
          "Delay cost acknowledged",
          "Forced outcome selected",
          "ObjectionResponse recorded"
        ],
        "error_handling": [
          {
            "error": "Agent creates urgency pressure",
            "response": "Guardrails block urgency tactics, only questions available"
          },
          {
            "error": "No outcome selected",
            "response": "Cannot close objection without forced outcome"
          }
        ]
      },
      {
        "id": "FLOW-011",
        "name": "Trigger Capacity Time Objection Subflow",
        "description": "Diagnostic subflow for workload objections to understand burnout versus project resistance patterns.",
        "feature_id": "FR-003",
        "story_ids": [
          "ST-010",
          "ST-011",
          "ST-014"
        ],
        "actor": "user",
        "trigger": "Prospect raises capacity or time concern at any milestone",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Agent selects 'Capacity/Time' from objection selector",
            "actor": "user",
            "inputs": [
              "objection_type_selection"
            ],
            "outputs": [
              "capacity_objection_activated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "System displays capacity objection diagnostic panel",
            "actor": "system",
            "inputs": [
              "objection_id"
            ],
            "outputs": [
              "diagnostic_panel_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Ask reframe question: manual overload vs new project resistance",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "reframe_question_asked"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Capture reframe response",
            "actor": "user",
            "inputs": [
              "reframe_response"
            ],
            "outputs": [
              "reframe_captured"
            ],
            "conditions": [
              {
                "condition": "response == manual_overload",
                "outcome": "explore_current_burden"
              },
              {
                "condition": "response == new_project_resistance",
                "outcome": "explore_project_fear"
              }
            ],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Identify core fear",
            "actor": "user",
            "inputs": [
              "core_fear_identification"
            ],
            "outputs": [
              "core_fear_recorded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Ask reality question about current trajectory",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "reality_question_asked"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Capture trajectory response",
            "actor": "user",
            "inputs": [
              "trajectory_response"
            ],
            "outputs": [
              "trajectory_captured"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Alignment check on work reduction belief",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "alignment_question_asked"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Capture alignment response",
            "actor": "user",
            "inputs": [
              "alignment_response"
            ],
            "outputs": [
              "alignment_captured"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "Agent adds diagnostic notes",
            "actor": "user",
            "inputs": [
              "objection_notes"
            ],
            "outputs": [
              "notes_saved"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "Select forced outcome",
            "actor": "user",
            "inputs": [
              "objection_outcome"
            ],
            "outputs": [
              "outcome_recorded"
            ],
            "conditions": [
              {
                "condition": "outcome == resolved",
                "outcome": "return_to_milestone"
              },
              {
                "condition": "outcome == deferred",
                "outcome": "flag_for_follow_up"
              },
              {
                "condition": "outcome == disqualified",
                "outcome": "route_to_disqualification"
              }
            ],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "System records ObjectionResponse and routes accordingly",
            "actor": "system",
            "inputs": [
              "call_session_id",
              "objection_id",
              "milestone_id",
              "outcome",
              "notes"
            ],
            "outputs": [
              "objection_response_saved",
              "routing_determined"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "Reframe question distinguishes overload from resistance",
          "Core fear identified",
          "Current trajectory reality explored",
          "Work reduction alignment checked",
          "Forced outcome selected",
          "ObjectionResponse recorded"
        ],
        "error_handling": [
          {
            "error": "Agent minimizes workload concerns",
            "response": "Guardrails ensure diagnostic approach, not dismissal"
          },
          {
            "error": "No outcome selected",
            "response": "Cannot close objection without forced outcome"
          }
        ]
      },
      {
        "id": "FLOW-012",
        "name": "Trigger Need to Think Objection Subflow",
        "description": "Diagnostic subflow for thinking objections to isolate the specific variable causing hesitation.",
        "feature_id": "FR-003",
        "story_ids": [
          "ST-010",
          "ST-011",
          "ST-015"
        ],
        "actor": "user",
        "trigger": "Prospect says they need to think about it at any milestone",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Agent selects 'Need to Think' from objection selector",
            "actor": "user",
            "inputs": [
              "objection_type_selection"
            ],
            "outputs": [
              "think_objection_activated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "System displays think objection diagnostic panel",
            "actor": "system",
            "inputs": [
              "objection_id"
            ],
            "outputs": [
              "diagnostic_panel_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Ask Step 1: 'What specifically do you want to think through?'",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "specificity_question_asked"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Capture prospect response",
            "actor": "user",
            "inputs": [
              "think_about_response"
            ],
            "outputs": [
              "response_captured"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Step 2: Isolate the variable",
            "actor": "user",
            "inputs": [
              "variable_classification"
            ],
            "outputs": [
              "variable_recorded"
            ],
            "conditions": [
              {
                "condition": "variable == price",
                "outcome": "route_to_price_subflow"
              },
              {
                "condition": "variable == risk",
                "outcome": "explore_risk_concern"
              },
              {
                "condition": "variable == trust",
                "outcome": "explore_trust_concern"
              },
              {
                "condition": "variable == partner",
                "outcome": "route_to_partner_subflow"
              },
              {
                "condition": "variable == self_doubt",
                "outcome": "explore_self_doubt"
              }
            ],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Step 3: Ask containment question for the isolated variable",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "containment_question_asked"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Capture containment response",
            "actor": "user",
            "inputs": [
              "containment_response"
            ],
            "outputs": [
              "containment_captured"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Route to relevant subflow if variable matches another objection type",
            "actor": "system",
            "inputs": [
              "variable_classification"
            ],
            "outputs": [
              "subflow_routing"
            ],
            "conditions": [
              {
                "condition": "variable == price",
                "outcome": "trigger_FLOW_009"
              },
              {
                "condition": "variable == partner",
                "outcome": "trigger_FLOW_013"
              }
            ],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Agent adds diagnostic notes",
            "actor": "user",
            "inputs": [
              "objection_notes"
            ],
            "outputs": [
              "notes_saved"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "Select forced outcome",
            "actor": "user",
            "inputs": [
              "objection_outcome"
            ],
            "outputs": [
              "outcome_recorded"
            ],
            "conditions": [
              {
                "condition": "outcome == resolved",
                "outcome": "return_to_milestone"
              },
              {
                "condition": "outcome == deferred",
                "outcome": "flag_for_follow_up"
              },
              {
                "condition": "outcome == disqualified",
                "outcome": "route_to_disqualification"
              }
            ],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "System records ObjectionResponse and routes accordingly",
            "actor": "system",
            "inputs": [
              "call_session_id",
              "objection_id",
              "milestone_id",
              "outcome",
              "notes"
            ],
            "outputs": [
              "objection_response_saved",
              "routing_determined"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "'What specifically?' question asked",
          "Variable isolated (price/risk/trust/partner/self-doubt)",
          "Containment question asked",
          "Routed to appropriate subflow if applicable",
          "Forced outcome selected",
          "ObjectionResponse recorded"
        ],
        "error_handling": [
          {
            "error": "Prospect cannot articulate variable",
            "response": "Agent uses prompts to help isolate, notes uncertainty"
          },
          {
            "error": "Agent pressures for immediate decision",
            "response": "Guardrails block pressure tactics"
          }
        ]
      },
      {
        "id": "FLOW-013",
        "name": "Trigger Partner Team Objection Subflow",
        "description": "Diagnostic subflow for authority objections to understand decision dynamics and equip prospect for internal conversations.",
        "feature_id": "FR-003",
        "story_ids": [
          "ST-010",
          "ST-011",
          "ST-016"
        ],
        "actor": "user",
        "trigger": "Prospect mentions needing to consult partner or team at any milestone",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Agent selects 'Partner/Team' from objection selector",
            "actor": "user",
            "inputs": [
              "objection_type_selection"
            ],
            "outputs": [
              "partner_objection_activated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "System displays partner objection diagnostic panel",
            "actor": "system",
            "inputs": [
              "objection_id"
            ],
            "outputs": [
              "diagnostic_panel_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Step 1: Authority clarification - can make decision vs need permission",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "authority_question_asked"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Capture authority response",
            "actor": "user",
            "inputs": [
              "authority_response"
            ],
            "outputs": [
              "authority_captured"
            ],
            "conditions": [
              {
                "condition": "can_decide_alone",
                "outcome": "explore_why_consulting"
              },
              {
                "condition": "needs_permission",
                "outcome": "explore_decision_dynamics"
              }
            ],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Step 2: Pre-solve anticipated partner concerns",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "presolve_question_asked"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Capture anticipated concerns",
            "actor": "user",
            "inputs": [
              "anticipated_concerns"
            ],
            "outputs": [
              "concerns_captured"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Step 3: Equip with explanation summary",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "summary_provided"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "System generates explanation summary for prospect to use",
            "actor": "system",
            "inputs": [
              "call_data",
              "value_proposition"
            ],
            "outputs": [
              "explanation_summary_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Check for conditional close if aligned after conversation",
            "actor": "user",
            "inputs": [
              "alignment_check"
            ],
            "outputs": [
              "conditional_close_possible"
            ],
            "conditions": [
              {
                "condition": "prospect_aligned",
                "outcome": "offer_conditional_close"
              },
              {
                "condition": "prospect_uncertain",
                "outcome": "schedule_follow_up"
              }
            ],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "Agent adds diagnostic notes",
            "actor": "user",
            "inputs": [
              "objection_notes"
            ],
            "outputs": [
              "notes_saved"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "Select forced outcome",
            "actor": "user",
            "inputs": [
              "objection_outcome"
            ],
            "outputs": [
              "outcome_recorded"
            ],
            "conditions": [
              {
                "condition": "outcome == resolved",
                "outcome": "return_to_milestone"
              },
              {
                "condition": "outcome == deferred",
                "outcome": "flag_for_follow_up"
              },
              {
                "condition": "outcome == disqualified",
                "outcome": "route_to_disqualification"
              }
            ],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "System records ObjectionResponse and routes accordingly",
            "actor": "system",
            "inputs": [
              "call_session_id",
              "objection_id",
              "milestone_id",
              "outcome",
              "notes"
            ],
            "outputs": [
              "objection_response_saved",
              "routing_determined"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "Authority clarified (can decide vs needs permission)",
          "Partner concerns pre-solved",
          "Explanation summary provided for internal conversation",
          "Conditional close offered if aligned",
          "Forced outcome selected",
          "ObjectionResponse recorded"
        ],
        "error_handling": [
          {
            "error": "Agent bypasses partner involvement",
            "response": "Guardrails ensure respect for decision dynamics"
          },
          {
            "error": "No outcome selected",
            "response": "Cannot close objection without forced outcome"
          }
        ]
      },
      {
        "id": "FLOW-014",
        "name": "Trigger Skepticism Objection Subflow",
        "description": "Diagnostic subflow for skepticism objections to understand past experience patterns and distinguish strategy from execution issues.",
        "feature_id": "FR-003",
        "story_ids": [
          "ST-010",
          "ST-011",
          "ST-017"
        ],
        "actor": "user",
        "trigger": "Prospect expresses skepticism based on past experiences at any milestone",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Agent selects 'Skepticism' from objection selector",
            "actor": "user",
            "inputs": [
              "objection_type_selection"
            ],
            "outputs": [
              "skepticism_objection_activated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "System displays skepticism objection diagnostic panel",
            "actor": "system",
            "inputs": [
              "objection_id"
            ],
            "outputs": [
              "diagnostic_panel_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Step 1: Validate experience - ask what did not work",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "validation_question_asked"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Capture past experience details",
            "actor": "user",
            "inputs": [
              "past_experience_response"
            ],
            "outputs": [
              "experience_captured"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Step 2: Pattern recognition - strategy vs execution issue",
            "actor": "user",
            "inputs": [
              "pattern_classification"
            ],
            "outputs": [
              "pattern_recorded"
            ],
            "conditions": [
              {
                "condition": "issue == strategy",
                "outcome": "explore_strategy_mismatch"
              },
              {
                "condition": "issue == execution",
                "outcome": "explore_execution_failure"
              }
            ],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Capture pattern analysis",
            "actor": "user",
            "inputs": [
              "pattern_analysis_notes"
            ],
            "outputs": [
              "analysis_captured"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Step 3: Articulate structural difference",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "structural_difference_explained"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Check if distinction understood",
            "actor": "user",
            "inputs": [
              "distinction_understood"
            ],
            "outputs": [
              "understanding_captured"
            ],
            "conditions": [
              {
                "condition": "distinction_understood",
                "outcome": "proceed_possible"
              },
              {
                "condition": "still_tactic_focused",
                "outcome": "consider_disqualification"
              }
            ],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Agent adds diagnostic notes",
            "actor": "user",
            "inputs": [
              "objection_notes"
            ],
            "outputs": [
              "notes_saved"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "Select forced outcome",
            "actor": "user",
            "inputs": [
              "objection_outcome"
            ],
            "outputs": [
              "outcome_recorded"
            ],
            "conditions": [
              {
                "condition": "outcome == resolved AND distinction_understood",
                "outcome": "return_to_milestone"
              },
              {
                "condition": "outcome == deferred",
                "outcome": "flag_for_follow_up"
              },
              {
                "condition": "outcome == disqualified OR tactic_focused",
                "outcome": "route_to_disqualification"
              }
            ],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "System records ObjectionResponse and routes accordingly",
            "actor": "system",
            "inputs": [
              "call_session_id",
              "objection_id",
              "milestone_id",
              "outcome",
              "notes"
            ],
            "outputs": [
              "objection_response_saved",
              "routing_determined"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "Past experience validated without dismissal",
          "Pattern recognized (strategy vs execution)",
          "Structural difference articulated",
          "Distinction understood check performed",
          "Disqualification if tactic-focused mindset persists",
          "Forced outcome selected",
          "ObjectionResponse recorded"
        ],
        "error_handling": [
          {
            "error": "Agent dismisses past experience",
            "response": "Guardrails ensure validation approach"
          },
          {
            "error": "Prospect remains tactic-focused",
            "response": "Recommend disqualification to protect quality"
          }
        ]
      },
      {
        "id": "FLOW-015",
        "name": "Complete Call with Outcome Classification",
        "description": "Sales agent classifies the call outcome at the end of every call with mandatory disqualification reasons when applicable.",
        "feature_id": "FR-006",
        "story_ids": [
          "ST-020"
        ],
        "actor": "user",
        "trigger": "M7 completed or call ends at any point",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "System displays call outcome classification panel",
            "actor": "system",
            "inputs": [
              "call_session_id",
              "milestones_completed"
            ],
            "outputs": [
              "outcome_panel_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "Select forced outcome type",
            "actor": "user",
            "inputs": [
              "outcome_type_selection"
            ],
            "outputs": [
              "outcome_type_recorded"
            ],
            "conditions": [
              {
                "condition": "outcome == coaching_client",
                "outcome": "route_to_onboarding"
              },
              {
                "condition": "outcome == follow_up_scheduled",
                "outcome": "route_to_follow_up_flow"
              },
              {
                "condition": "outcome == implementation_only",
                "outcome": "route_to_implementation_pipeline"
              },
              {
                "condition": "outcome == disqualified",
                "outcome": "require_disqualification_reason"
              }
            ],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "If disqualified: select mandatory disqualification reason",
            "actor": "user",
            "inputs": [
              "disqualification_reason"
            ],
            "outputs": [
              "reason_recorded"
            ],
            "conditions": [
              {
                "condition": "reason == under_500_clients",
                "outcome": "record_client_count_issue"
              },
              {
                "condition": "reason == cashflow_mismatch",
                "outcome": "record_financial_issue"
              },
              {
                "condition": "reason == misaligned_expectations",
                "outcome": "record_alignment_issue"
              },
              {
                "condition": "reason == capacity_constraint",
                "outcome": "record_capacity_issue"
              },
              {
                "condition": "reason == authority_issue",
                "outcome": "record_authority_issue"
              }
            ],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Set qualification flags",
            "actor": "user",
            "inputs": [
              "qualification_flag_values"
            ],
            "outputs": [
              "flags_recorded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "System validates outcome data completeness",
            "actor": "system",
            "inputs": [
              "outcome_type",
              "disqualification_reason",
              "qualification_flags"
            ],
            "outputs": [
              "validation_result"
            ],
            "conditions": [
              {
                "condition": "disqualified AND no_reason",
                "outcome": "block_completion"
              }
            ],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Add final call notes",
            "actor": "user",
            "inputs": [
              "final_notes"
            ],
            "outputs": [
              "notes_saved"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Confirm call completion",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "completion_confirmed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "System creates Outcome record and updates CallSession status",
            "actor": "system",
            "inputs": [
              "call_session_id",
              "outcome_type",
              "disqualification_reason",
              "qualification_flags",
              "notes"
            ],
            "outputs": [
              "outcome_record_created",
              "call_session_status_complete"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "System triggers appropriate pipeline actions",
            "actor": "system",
            "inputs": [
              "outcome_type"
            ],
            "outputs": [
              "pipeline_actions_triggered"
            ],
            "conditions": [
              {
                "condition": "coaching_client",
                "outcome": "trigger_coaching_onboarding_pipeline"
              },
              {
                "condition": "follow_up",
                "outcome": "trigger_follow_up_scheduling"
              },
              {
                "condition": "implementation",
                "outcome": "trigger_implementation_pipeline"
              }
            ],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "System triggers AI post-call analysis (SFLOW-003)",
            "actor": "system",
            "inputs": [
              "call_session_id",
              "recording_reference"
            ],
            "outputs": [
              "ai_analysis_job_queued"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "Forced outcome selected from: Coaching client, Follow-up scheduled, Implementation only, Disqualified",
          "If disqualified: mandatory reason selected",
          "Qualification flags set: 500+ clients, Financial capacity, Strategic alignment",
          "Outcome record created",
          "CallSession marked complete",
          "Pipeline actions triggered",
          "AI analysis queued"
        ],
        "error_handling": [
          {
            "error": "No outcome selected",
            "response": "Cannot complete call without outcome classification"
          },
          {
            "error": "Disqualified without reason",
            "response": "Reason field required, cannot proceed without"
          },
          {
            "error": "Pipeline action fails",
            "response": "Log error, allow retry, alert manager"
          }
        ]
      },
      {
        "id": "FLOW-016",
        "name": "Review Call History",
        "description": "Sales agent reviews their call history including past sessions, outcomes, notes, and AI-generated insights.",
        "feature_id": "FR-007",
        "story_ids": [
          "ST-022"
        ],
        "actor": "user",
        "trigger": "Agent navigates to call history from dashboard",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Agent navigates to Call History section",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "call_history_view_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "System displays list of past calls with filters",
            "actor": "system",
            "inputs": [
              "agent_id",
              "date_range",
              "outcome_filter"
            ],
            "outputs": [
              "call_list_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Agent applies filters (date, outcome type, prospect)",
            "actor": "user",
            "inputs": [
              "filter_criteria"
            ],
            "outputs": [
              "filtered_list_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Agent selects a specific call to review",
            "actor": "user",
            "inputs": [
              "call_session_id"
            ],
            "outputs": [
              "call_detail_view_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "System displays call summary and metadata",
            "actor": "system",
            "inputs": [
              "call_session_id"
            ],
            "outputs": [
              "call_summary_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "View milestone completion timeline",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "milestone_timeline_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "View objection history and outcomes",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "objection_history_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "View notes captured during call",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "notes_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "View AI-generated analysis (if available)",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "ai_analysis_displayed"
            ],
            "conditions": [
              {
                "condition": "ai_analysis_not_ready",
                "outcome": "show_pending_status"
              }
            ],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "Access recording and transcript (if available)",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "recording_access_granted"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "View follow-up call chain if part of thread",
            "actor": "user",
            "inputs": [
              "call_thread_id"
            ],
            "outputs": [
              "call_thread_displayed"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "Call history loads with all past sessions",
          "Filters work correctly (date, outcome, prospect)",
          "Call detail shows complete summary",
          "Milestone timeline accurately reflects call progression",
          "Objection history with outcomes visible",
          "Notes accessible",
          "AI analysis viewable when complete",
          "Recording/transcript accessible"
        ],
        "error_handling": [
          {
            "error": "Recording not available",
            "response": "Display message explaining recording status"
          },
          {
            "error": "AI analysis still processing",
            "response": "Show processing indicator with estimated time"
          }
        ]
      },
      {
        "id": "FLOW-017",
        "name": "Conduct Follow-Up Call",
        "description": "Sales agent conducts a follow-up call with full context from previous sessions, resuming at the appropriate milestone.",
        "feature_id": "FR-007",
        "story_ids": [
          "ST-021",
          "ST-022"
        ],
        "actor": "user",
        "trigger": "Scheduled follow-up appears in calendar or agent selects follow-up from prospect record",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Agent selects follow-up call from calendar or prospect record",
            "actor": "user",
            "inputs": [
              "scheduled_call_id",
              "prospect_id"
            ],
            "outputs": [
              "follow_up_context_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "System displays previous call summary",
            "actor": "system",
            "inputs": [
              "call_thread_id",
              "primary_call_id"
            ],
            "outputs": [
              "previous_summary_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "System shows last completed milestone",
            "actor": "system",
            "inputs": [
              "previous_call_milestones"
            ],
            "outputs": [
              "last_milestone_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "System lists unresolved objections from previous call",
            "actor": "system",
            "inputs": [
              "previous_objection_responses"
            ],
            "outputs": [
              "unresolved_objections_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "System highlights open decision variables",
            "actor": "system",
            "inputs": [
              "previous_call_data"
            ],
            "outputs": [
              "decision_variables_highlighted"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "System shows qualification flags status",
            "actor": "system",
            "inputs": [
              "prospect_qualification_data"
            ],
            "outputs": [
              "qualification_status_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Agent reviews context and prepares",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "context_reviewed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Agent chooses resume point: continue at milestone OR jump to decision",
            "actor": "user",
            "inputs": [
              "resume_option"
            ],
            "outputs": [
              "resume_point_selected"
            ],
            "conditions": [
              {
                "condition": "resume_at_milestone",
                "outcome": "load_milestone_panel"
              },
              {
                "condition": "jump_to_decision",
                "outcome": "load_m7_panel"
              }
            ],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Complete abbreviated pre-call checklist for follow-up",
            "actor": "user",
            "inputs": [
              "follow_up_checklist_items"
            ],
            "outputs": [
              "checklist_completed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "Paste Zoom link to activate recording",
            "actor": "user",
            "inputs": [
              "zoom_link"
            ],
            "outputs": [
              "recording_initialized"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "System creates new CallSession linked to CallThread",
            "actor": "system",
            "inputs": [
              "prospect_id",
              "agent_id",
              "call_thread_id",
              "primary_call_id"
            ],
            "outputs": [
              "follow_up_session_created"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "Execute call from resume point (uses standard milestone flows)",
            "actor": "user",
            "inputs": [
              "resume_milestone_id"
            ],
            "outputs": [
              "call_in_progress"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-013"
            ]
          },
          {
            "id": "STEP-013",
            "sequence": 13,
            "action": "Address unresolved objections if they resurface",
            "actor": "user",
            "inputs": [
              "objection_updates"
            ],
            "outputs": [
              "objections_updated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-014"
            ]
          },
          {
            "id": "STEP-014",
            "sequence": 14,
            "action": "Complete call with outcome classification (FLOW-015)",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "outcome_classified"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "Previous call summary visible before starting",
          "Last milestone clearly indicated",
          "Unresolved objections listed and accessible",
          "Decision variables highlighted",
          "Qualification flags status shown",
          "Resume at milestone OR jump to decision option available",
          "New CallSession linked to existing CallThread",
          "Seamless continuation of sales process"
        ],
        "error_handling": [
          {
            "error": "Previous call data unavailable",
            "response": "Alert agent, allow proceeding with limited context"
          },
          {
            "error": "CallThread not found",
            "response": "Create new thread with this as primary call"
          }
        ]
      },
      {
        "id": "FLOW-018",
        "name": "Review Team Performance Dashboard",
        "description": "Manager reviews call analytics, agent metrics, and performance patterns across the team.",
        "feature_id": "FR-014",
        "story_ids": [
          "ST-032"
        ],
        "actor": "user",
        "trigger": "Manager navigates to dashboard from main menu",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Manager navigates to Performance Dashboard",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "dashboard_view_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "System verifies manager role access",
            "actor": "system",
            "inputs": [
              "user_role"
            ],
            "outputs": [
              "access_granted"
            ],
            "conditions": [
              {
                "condition": "role != manager AND role != admin",
                "outcome": "access_denied"
              }
            ],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "System renders dashboard with default date range",
            "actor": "system",
            "inputs": [
              "team_id",
              "default_date_range"
            ],
            "outputs": [
              "dashboard_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "View calls per agent metrics",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "calls_per_agent_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "View objection frequency by type",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "objection_frequency_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "View close rate by qualification status",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "close_rate_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "View time spent per milestone averages",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "milestone_time_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "View AI risk flags summary",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "risk_flags_summary_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "View slide effectiveness scores",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "slide_effectiveness_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "Access ROI tool integration for projected vs actual comparison",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "roi_comparison_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "Apply date range and agent filters",
            "actor": "user",
            "inputs": [
              "date_range",
              "agent_filter"
            ],
            "outputs": [
              "filtered_metrics_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "Drill down into specific agent or call",
            "actor": "user",
            "inputs": [
              "drill_down_selection"
            ],
            "outputs": [
              "detail_view_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-013"
            ]
          },
          {
            "id": "STEP-013",
            "sequence": 13,
            "action": "Export metrics report if needed",
            "actor": "user",
            "inputs": [
              "export_format"
            ],
            "outputs": [
              "report_exported"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "Dashboard loads with all metric widgets",
          "Calls per agent accurately displayed",
          "Objection frequency breakdown visible",
          "Close rate by qualification shown",
          "Milestone time averages calculated",
          "AI risk flags summarized",
          "Slide effectiveness scores available",
          "ROI projected vs actual comparison functional",
          "Filters and drill-down working"
        ],
        "error_handling": [
          {
            "error": "Access denied for non-manager role",
            "response": "Display access denied message, redirect to appropriate view"
          },
          {
            "error": "Metrics calculation timeout",
            "response": "Show partial data with loading indicator for remaining"
          }
        ]
      },
      {
        "id": "FLOW-019",
        "name": "Analyze Call Recordings and AI Insights",
        "description": "Manager reviews call recordings, transcripts, and AI-generated analysis for coaching and quality assurance.",
        "feature_id": "FR-011",
        "story_ids": [
          "ST-028",
          "ST-029"
        ],
        "actor": "user",
        "trigger": "Manager selects a call for review from dashboard or call list",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Manager selects call for review",
            "actor": "user",
            "inputs": [
              "call_session_id"
            ],
            "outputs": [
              "call_review_view_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "System verifies manager role access",
            "actor": "system",
            "inputs": [
              "user_role"
            ],
            "outputs": [
              "access_granted"
            ],
            "conditions": [
              {
                "condition": "role != manager AND role != admin",
                "outcome": "access_denied"
              }
            ],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "System loads call metadata and summary",
            "actor": "system",
            "inputs": [
              "call_session_id"
            ],
            "outputs": [
              "call_metadata_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Access call recording player",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "recording_player_loaded"
            ],
            "conditions": [
              {
                "condition": "recording_not_available",
                "outcome": "show_unavailable_message"
              }
            ],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Play recording with speaker detection labels",
            "actor": "user",
            "inputs": [
              "playback_controls"
            ],
            "outputs": [
              "recording_playing"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "View synchronized transcript",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "transcript_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Navigate using timeline markers (milestones, objections, slides)",
            "actor": "user",
            "inputs": [
              "timeline_marker_selection"
            ],
            "outputs": [
              "playback_position_updated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "View AI-generated call summary",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "ai_summary_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "View objection classification analysis",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "objection_analysis_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "View decision readiness score",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "readiness_score_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "Review AI risk flags (misalignment, overpromise, pressure)",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "risk_flags_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "View agent execution feedback from AI",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "execution_feedback_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-013"
            ]
          },
          {
            "id": "STEP-013",
            "sequence": 13,
            "action": "View slide effectiveness signals",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "slide_signals_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-014"
            ]
          },
          {
            "id": "STEP-014",
            "sequence": 14,
            "action": "Verify all AI outputs have traceable call evidence",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "evidence_links_verified"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-015"
            ]
          },
          {
            "id": "STEP-015",
            "sequence": 15,
            "action": "Add manager notes or coaching feedback",
            "actor": "user",
            "inputs": [
              "manager_notes"
            ],
            "outputs": [
              "notes_saved"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "Recording plays with speaker detection",
          "Transcript synchronized with playback",
          "Timeline markers for milestones/objections/slides functional",
          "AI summary is factual and neutral",
          "Objection classification visible",
          "Decision readiness score displayed",
          "Risk flags (misalignment, overpromise, pressure) shown",
          "Agent execution feedback available",
          "All AI outputs traceable to call evidence",
          "Manager can add coaching notes"
        ],
        "error_handling": [
          {
            "error": "Recording not yet processed",
            "response": "Show processing status and estimated completion time"
          },
          {
            "error": "AI analysis failed",
            "response": "Display error, offer manual review option, log for retry"
          },
          {
            "error": "Transcript sync issues",
            "response": "Allow manual navigation, flag for technical review"
          }
        ]
      },
      {
        "id": "FLOW-020",
        "name": "Configure Milestones and Questions",
        "description": "Admin configures milestone definitions including titles, objectives, required questions, and confirmations.",
        "feature_id": "FR-015",
        "story_ids": [
          "ST-033"
        ],
        "actor": "admin",
        "trigger": "Admin navigates to milestone configuration from admin panel",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Admin navigates to Admin Configuration Panel",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "admin_panel_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "System verifies admin role",
            "actor": "system",
            "inputs": [
              "user_role"
            ],
            "outputs": [
              "access_granted"
            ],
            "conditions": [
              {
                "condition": "role != admin",
                "outcome": "access_denied"
              }
            ],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Select Milestones configuration section",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "milestone_config_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "System displays list of all milestones (M1-M7)",
            "actor": "system",
            "inputs": [],
            "outputs": [
              "milestone_list_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Select milestone to edit",
            "actor": "user",
            "inputs": [
              "milestone_id"
            ],
            "outputs": [
              "milestone_editor_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Edit milestone title",
            "actor": "user",
            "inputs": [
              "milestone_title",
              "milestone_title_de"
            ],
            "outputs": [
              "title_updated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Edit milestone objective",
            "actor": "user",
            "inputs": [
              "milestone_objective",
              "milestone_objective_de"
            ],
            "outputs": [
              "objective_updated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Configure required questions",
            "actor": "user",
            "inputs": [
              "question_list"
            ],
            "outputs": [
              "questions_updated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Configure confirmation checkboxes",
            "actor": "user",
            "inputs": [
              "confirmation_list"
            ],
            "outputs": [
              "confirmations_updated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "Set time indicator (suggested duration)",
            "actor": "user",
            "inputs": [
              "time_indicator"
            ],
            "outputs": [
              "time_updated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "Preview changes",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "preview_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "Save changes as draft",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "draft_saved"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-013"
            ]
          },
          {
            "id": "STEP-013",
            "sequence": 13,
            "action": "Publish changes (with version increment)",
            "actor": "user",
            "inputs": [
              "publish_confirmation"
            ],
            "outputs": [
              "new_version_published"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-014"
            ]
          },
          {
            "id": "STEP-014",
            "sequence": 14,
            "action": "System logs change with audit trail",
            "actor": "system",
            "inputs": [
              "admin_id",
              "change_details",
              "timestamp"
            ],
            "outputs": [
              "audit_log_created"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "Admin can access milestone configuration",
          "All 7 milestones editable",
          "Title and objective support DE/EN",
          "Questions and confirmations configurable",
          "Time indicator settable",
          "Preview before publish available",
          "Version control with rollback capability",
          "Audit trail for all changes"
        ],
        "error_handling": [
          {
            "error": "Access denied",
            "response": "Display access denied message, redirect"
          },
          {
            "error": "Validation error on save",
            "response": "Highlight invalid fields, prevent save until corrected"
          },
          {
            "error": "Publish conflict",
            "response": "Alert admin, require conflict resolution"
          }
        ]
      },
      {
        "id": "FLOW-021",
        "name": "Manage Objection Types and Subflows",
        "description": "Admin configures objection types with their diagnostic questions and allowed outcomes.",
        "feature_id": "FR-015",
        "story_ids": [
          "ST-033"
        ],
        "actor": "admin",
        "trigger": "Admin navigates to objection configuration from admin panel",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Admin navigates to Admin Configuration Panel",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "admin_panel_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "System verifies admin role",
            "actor": "system",
            "inputs": [
              "user_role"
            ],
            "outputs": [
              "access_granted"
            ],
            "conditions": [
              {
                "condition": "role != admin",
                "outcome": "access_denied"
              }
            ],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Select Objection Flows configuration section",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "objection_config_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "System displays list of objection types",
            "actor": "system",
            "inputs": [],
            "outputs": [
              "objection_list_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Select objection type to edit or create new",
            "actor": "user",
            "inputs": [
              "objection_id"
            ],
            "outputs": [
              "objection_editor_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Edit objection type name and description",
            "actor": "user",
            "inputs": [
              "objection_type_name",
              "description",
              "name_de",
              "description_de"
            ],
            "outputs": [
              "type_updated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Configure diagnostic questions (max 3)",
            "actor": "user",
            "inputs": [
              "diagnostic_questions"
            ],
            "outputs": [
              "questions_updated"
            ],
            "conditions": [
              {
                "condition": "questions > 3",
                "outcome": "block_validation_error"
              }
            ],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Configure question sequence and conditions",
            "actor": "user",
            "inputs": [
              "question_sequence",
              "conditions"
            ],
            "outputs": [
              "sequence_updated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Configure allowed outcomes (Resolved, Deferred, Disqualified)",
            "actor": "user",
            "inputs": [
              "allowed_outcomes"
            ],
            "outputs": [
              "outcomes_updated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "Configure routing rules per outcome",
            "actor": "user",
            "inputs": [
              "routing_rules"
            ],
            "outputs": [
              "routing_updated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "Verify no persuasion or rebuttal content",
            "actor": "system",
            "inputs": [
              "all_question_content"
            ],
            "outputs": [
              "guardrail_check_passed"
            ],
            "conditions": [
              {
                "condition": "persuasion_detected",
                "outcome": "block_with_warning"
              }
            ],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "Preview objection subflow",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "preview_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-013"
            ]
          },
          {
            "id": "STEP-013",
            "sequence": 13,
            "action": "Activate or deactivate objection type",
            "actor": "user",
            "inputs": [
              "activation_status"
            ],
            "outputs": [
              "status_updated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-014"
            ]
          },
          {
            "id": "STEP-014",
            "sequence": 14,
            "action": "Publish changes with version control",
            "actor": "user",
            "inputs": [
              "publish_confirmation"
            ],
            "outputs": [
              "new_version_published"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-015"
            ]
          },
          {
            "id": "STEP-015",
            "sequence": 15,
            "action": "System logs change with audit trail",
            "actor": "system",
            "inputs": [
              "admin_id",
              "change_details",
              "timestamp"
            ],
            "outputs": [
              "audit_log_created"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "All 6 objection types manageable",
          "Diagnostic questions limited to 1-3 per type",
          "Questions support DE/EN",
          "Outcomes configurable (Resolved/Deferred/Disqualified)",
          "Routing rules definable per outcome",
          "Guardrails prevent persuasion content",
          "Preview before publish",
          "Activate/deactivate capability",
          "Version control and audit trail"
        ],
        "error_handling": [
          {
            "error": "More than 3 questions configured",
            "response": "Block save, display limit warning"
          },
          {
            "error": "Persuasion content detected",
            "response": "Block save, highlight problematic content"
          },
          {
            "error": "Missing required fields",
            "response": "Highlight required fields, prevent save"
          }
        ]
      },
      {
        "id": "FLOW-022",
        "name": "Configure AI Prompts",
        "description": "Admin manages AI prompts across all 5 layers with versioning, variable support, and language variants.",
        "feature_id": "FR-016",
        "story_ids": [
          "ST-034"
        ],
        "actor": "admin",
        "trigger": "Admin navigates to AI prompt configuration from admin panel",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Admin navigates to Admin Configuration Panel",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "admin_panel_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "System verifies admin role",
            "actor": "system",
            "inputs": [
              "user_role"
            ],
            "outputs": [
              "access_granted"
            ],
            "conditions": [
              {
                "condition": "role != admin",
                "outcome": "access_denied"
              }
            ],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Select AI Prompt Registry section",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "prompt_registry_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "System displays prompts organized by scope",
            "actor": "system",
            "inputs": [],
            "outputs": [
              "prompt_list_by_scope"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Select prompt scope (Global, Milestone, Objection, Slide, Analysis)",
            "actor": "user",
            "inputs": [
              "scope_selection"
            ],
            "outputs": [
              "scope_prompts_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Select specific prompt to edit or create new",
            "actor": "user",
            "inputs": [
              "prompt_id"
            ],
            "outputs": [
              "prompt_editor_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Edit prompt text (English version)",
            "actor": "user",
            "inputs": [
              "prompt_text_en"
            ],
            "outputs": [
              "en_text_updated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Edit prompt text (German version)",
            "actor": "user",
            "inputs": [
              "prompt_text_de"
            ],
            "outputs": [
              "de_text_updated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Configure variable placeholders",
            "actor": "user",
            "inputs": [
              "variable_definitions"
            ],
            "outputs": [
              "variables_updated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "System validates variable syntax",
            "actor": "system",
            "inputs": [
              "prompt_text",
              "variable_definitions"
            ],
            "outputs": [
              "syntax_validation_result"
            ],
            "conditions": [
              {
                "condition": "invalid_syntax",
                "outcome": "show_syntax_error"
              }
            ],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "If milestone/objection scope, link to specific entity",
            "actor": "user",
            "inputs": [
              "milestone_id_or_objection_id"
            ],
            "outputs": [
              "entity_linked"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "Set prompt status (draft, active, deprecated)",
            "actor": "user",
            "inputs": [
              "prompt_status"
            ],
            "outputs": [
              "status_updated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-013"
            ]
          },
          {
            "id": "STEP-013",
            "sequence": 13,
            "action": "Preview prompt with sample data",
            "actor": "user",
            "inputs": [
              "sample_data"
            ],
            "outputs": [
              "preview_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-014"
            ]
          },
          {
            "id": "STEP-014",
            "sequence": 14,
            "action": "Save as new version",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "version_created"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-015"
            ]
          },
          {
            "id": "STEP-015",
            "sequence": 15,
            "action": "Activate new version (deactivates previous)",
            "actor": "user",
            "inputs": [
              "activation_confirmation"
            ],
            "outputs": [
              "version_activated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-016"
            ]
          },
          {
            "id": "STEP-016",
            "sequence": 16,
            "action": "System logs execution for traceability",
            "actor": "system",
            "inputs": [
              "prompt_id",
              "version",
              "admin_id",
              "timestamp"
            ],
            "outputs": [
              "audit_log_created"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-017"
            ]
          },
          {
            "id": "STEP-017",
            "sequence": 17,
            "action": "Rollback to previous version if needed",
            "actor": "user",
            "inputs": [
              "rollback_version"
            ],
            "outputs": [
              "rollback_completed"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "5 prompt scopes accessible (Global, Milestone, Objection, Slide, Analysis)",
          "Versioned prompts with status tracking",
          "Language-specific prompts (DE/EN)",
          "Variable placeholders for runtime injection",
          "Logged execution for traceability",
          "Rollback capability",
          "Preview with sample data",
          "AI behavior governable without code changes"
        ],
        "error_handling": [
          {
            "error": "Invalid variable syntax",
            "response": "Highlight syntax error, prevent save"
          },
          {
            "error": "Missing language variant",
            "response": "Warn admin, allow save with incomplete translations"
          },
          {
            "error": "Activation conflict",
            "response": "Confirm deactivation of previous version before proceeding"
          }
        ]
      },
      {
        "id": "FLOW-023",
        "name": "Manage Users and Roles",
        "description": "Admin manages users and assigns roles (Sales Agent, Manager, Admin) with appropriate permissions.",
        "feature_id": "FR-013",
        "story_ids": [
          "ST-031"
        ],
        "actor": "admin",
        "trigger": "Admin navigates to user management from admin panel",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Admin navigates to Admin Configuration Panel",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "admin_panel_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "System verifies admin role",
            "actor": "system",
            "inputs": [
              "user_role"
            ],
            "outputs": [
              "access_granted"
            ],
            "conditions": [
              {
                "condition": "role != admin",
                "outcome": "access_denied"
              }
            ],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Select User Management section",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "user_management_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "System displays list of all users",
            "actor": "system",
            "inputs": [],
            "outputs": [
              "user_list_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Filter users by role or search",
            "actor": "user",
            "inputs": [
              "filter_criteria"
            ],
            "outputs": [
              "filtered_list_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Select user to edit or create new",
            "actor": "user",
            "inputs": [
              "user_id"
            ],
            "outputs": [
              "user_editor_loaded"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Edit user details (name, email)",
            "actor": "user",
            "inputs": [
              "user_name",
              "user_email"
            ],
            "outputs": [
              "details_updated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Assign role",
            "actor": "user",
            "inputs": [
              "role_selection"
            ],
            "outputs": [
              "role_assigned"
            ],
            "conditions": [
              {
                "condition": "role == sales_agent",
                "outcome": "set_agent_permissions"
              },
              {
                "condition": "role == manager",
                "outcome": "set_manager_permissions"
              },
              {
                "condition": "role == admin",
                "outcome": "set_admin_permissions"
              }
            ],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "System displays role permissions",
            "actor": "system",
            "inputs": [
              "role_selection"
            ],
            "outputs": [
              "permissions_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "Set language preference",
            "actor": "user",
            "inputs": [
              "language_preference"
            ],
            "outputs": [
              "language_set"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "Assign to team (if applicable)",
            "actor": "user",
            "inputs": [
              "team_assignment"
            ],
            "outputs": [
              "team_assigned"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "Save user changes",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "user_saved"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-013"
            ]
          },
          {
            "id": "STEP-013",
            "sequence": 13,
            "action": "Activate or deactivate user account",
            "actor": "user",
            "inputs": [
              "account_status"
            ],
            "outputs": [
              "status_updated"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-014"
            ]
          },
          {
            "id": "STEP-014",
            "sequence": 14,
            "action": "System logs change with audit trail",
            "actor": "system",
            "inputs": [
              "admin_id",
              "user_id",
              "change_details",
              "timestamp"
            ],
            "outputs": [
              "audit_log_created"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "User list with filtering accessible",
          "Create/edit/deactivate users",
          "3 roles assignable: Sales Agent, Manager, Admin",
          "Role permissions clearly displayed",
          "Language preference configurable",
          "Team assignment supported",
          "Audit trail for all changes"
        ],
        "error_handling": [
          {
            "error": "Duplicate email",
            "response": "Display error, require unique email"
          },
          {
            "error": "Last admin deactivation",
            "response": "Block action, require at least one admin"
          },
          {
            "error": "Invalid email format",
            "response": "Validate and display error"
          }
        ]
      },
      {
        "id": "FLOW-024",
        "name": "Use Dual Interface System",
        "description": "Sales agent uses the dual interface with Rep Control Panel and separate Client Presentation View for Zoom sharing.",
        "feature_id": "FR-008",
        "story_ids": [
          "ST-023",
          "ST-024"
        ],
        "actor": "user",
        "trigger": "Agent starts a call session and needs to present slides to client",
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Agent is in active call session on Rep Control Panel",
            "actor": "user",
            "inputs": [
              "call_session_id"
            ],
            "outputs": [
              "control_panel_active"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "Agent clicks 'Start Presentation Mode' button",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "presentation_mode_requested"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "System opens Client Presentation View in new browser tab",
            "actor": "system",
            "inputs": [
              "call_session_id",
              "slide_deck_id"
            ],
            "outputs": [
              "presentation_tab_opened"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "System establishes WebSocket connection between views",
            "actor": "system",
            "inputs": [
              "session_token"
            ],
            "outputs": [
              "websocket_connected"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Agent shares Presentation Tab in Zoom",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "screen_shared"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Client sees slides only (no controls, notes, or objections)",
            "actor": "system",
            "inputs": [],
            "outputs": [
              "client_view_rendered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Agent uses slide navigation buttons on Control Panel",
            "actor": "user",
            "inputs": [
              "navigation_action"
            ],
            "outputs": [
              "slide_navigation_triggered"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "System syncs slide change to Presentation View via WebSocket",
            "actor": "system",
            "inputs": [
              "slide_index",
              "slide_data"
            ],
            "outputs": [
              "slide_synced"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Control Panel displays full checklist and notes (hidden from client)",
            "actor": "system",
            "inputs": [],
            "outputs": [
              "private_ui_maintained"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "Agent triggers objection (not visible on Presentation View)",
            "actor": "user",
            "inputs": [
              "objection_trigger"
            ],
            "outputs": [
              "objection_panel_opened"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "Agent uses recording controls on Control Panel",
            "actor": "user",
            "inputs": [
              "recording_action"
            ],
            "outputs": [
              "recording_controlled"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "System renders personalized slide content from parameters",
            "actor": "system",
            "inputs": [
              "slide_template",
              "call_parameters"
            ],
            "outputs": [
              "personalized_slide_displayed"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-013"
            ]
          },
          {
            "id": "STEP-013",
            "sequence": 13,
            "action": "Agent ends presentation mode",
            "actor": "user",
            "inputs": [],
            "outputs": [
              "presentation_mode_ended"
            ],
            "conditions": [],
            "next_steps": [
              "STEP-014"
            ]
          },
          {
            "id": "STEP-014",
            "sequence": 14,
            "action": "Presentation tab closes or shows end screen",
            "actor": "system",
            "inputs": [],
            "outputs": [
              "presentation_closed"
            ],
            "conditions": [],
            "next_steps": []
          }
        ],
        "success_criteria": [
          "Presentation View opens in separate browser tab",
          "Client sees only slides, no controls/notes/objections",
          "Slave view controlled by Rep Panel",
          "WebSocket sync under 500ms latency",
          "Full checklist visible on Control Panel only",
          "Notes and confirmations editable on Control Panel",
          "Objection triggers accessible but hidden from client",
          "Recording controls on Control Panel",
          "Client-safe URL with no auth-sensitive UI",
          "Slide navigation synced live"
        ],
        "error_handling": [
          {
            "error": "WebSocket disconnection",
            "response": "Attempt automatic reconnection, show connection status"
          },
          {
            "error": "Presentation tab closed accidentally",
            "response": "Allow reopening from Control Panel"
          },
          {
            "error": "Sync latency exceeds 500ms",
            "response": "Log performance issue, continue with best effort"
          }
        ]
      }
    ],
    "system_flows": [
      {
        "id": "SFLOW-001",
        "name": "Pre-Call Checklist Enforcement",
        "description": "System flow that enforces mandatory pre-call preparation before allowing a call to start, including qualification verification.",
        "components": [
          "api",
          "database",
          "frontend"
        ],
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "User initiates new call session",
            "component": "frontend",
            "inputs": [
              "prospect_id",
              "agent_id"
            ],
            "outputs": [
              "session_request"
            ],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "API receives session creation request",
            "component": "api",
            "inputs": [
              "session_request"
            ],
            "outputs": [
              "request_validated"
            ],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Database retrieves prospect qualification data",
            "component": "database",
            "inputs": [
              "prospect_id"
            ],
            "outputs": [
              "prospect_data",
              "qualification_form_data"
            ],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "API generates checklist items based on prospect data",
            "component": "api",
            "inputs": [
              "prospect_data"
            ],
            "outputs": [
              "checklist_config"
            ],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Frontend renders pre-call checklist UI",
            "component": "frontend",
            "inputs": [
              "checklist_config",
              "prospect_data"
            ],
            "outputs": [
              "checklist_ui_displayed"
            ],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "User completes checklist items",
            "component": "frontend",
            "inputs": [
              "user_checklist_responses"
            ],
            "outputs": [
              "checklist_state"
            ],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Frontend validates client count (500+ gate)",
            "component": "frontend",
            "inputs": [
              "client_count_value"
            ],
            "outputs": [
              "qualification_result"
            ],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "API validates all checklist items complete",
            "component": "api",
            "inputs": [
              "checklist_state"
            ],
            "outputs": [
              "validation_result"
            ],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "System sets coaching_eligible flag based on qualification",
            "component": "api",
            "inputs": [
              "client_count",
              "qualification_responses"
            ],
            "outputs": [
              "coaching_eligible_flag"
            ],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "Database creates CallSession with pre-call data",
            "component": "database",
            "inputs": [
              "prospect_id",
              "agent_id",
              "checklist_data",
              "coaching_eligible_flag"
            ],
            "outputs": [
              "call_session_id",
              "call_session_status_active"
            ],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "API returns session ready response",
            "component": "api",
            "inputs": [
              "call_session_id"
            ],
            "outputs": [
              "session_ready_response"
            ],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "Frontend enables call start and loads M1",
            "component": "frontend",
            "inputs": [
              "session_ready_response"
            ],
            "outputs": [
              "call_interface_loaded"
            ],
            "next_steps": []
          }
        ],
        "data_flow": [
          {
            "from": "frontend",
            "to": "api",
            "data": "session_request with prospect_id"
          },
          {
            "from": "api",
            "to": "database",
            "data": "prospect qualification query"
          },
          {
            "from": "database",
            "to": "api",
            "data": "prospect_data with qualification_form"
          },
          {
            "from": "api",
            "to": "frontend",
            "data": "checklist_config"
          },
          {
            "from": "frontend",
            "to": "api",
            "data": "completed checklist_state"
          },
          {
            "from": "api",
            "to": "database",
            "data": "CallSession creation request"
          },
          {
            "from": "database",
            "to": "api",
            "data": "call_session_id"
          }
        ],
        "error_handling": [
          {
            "error": "Prospect not found",
            "response": "Return 404, display prospect not found message"
          },
          {
            "error": "Checklist validation failed",
            "response": "Return validation errors, highlight incomplete items"
          },
          {
            "error": "Database connection error",
            "response": "Return 503, display retry message"
          },
          {
            "error": "Client count below 500",
            "response": "Set coaching_eligible=false, allow advisory call only"
          }
        ]
      },
      {
        "id": "SFLOW-002",
        "name": "Qualification Gate Checks",
        "description": "System flow that enforces qualification requirements before allowing progression to M6 Offer Presentation.",
        "components": [
          "api",
          "database",
          "frontend"
        ],
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "User attempts to proceed to M6 milestone",
            "component": "frontend",
            "inputs": [
              "call_session_id",
              "current_milestone"
            ],
            "outputs": [
              "m6_navigation_request"
            ],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "API receives milestone progression request",
            "component": "api",
            "inputs": [
              "m6_navigation_request"
            ],
            "outputs": [
              "progression_request_received"
            ],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Database retrieves call session qualification data",
            "component": "database",
            "inputs": [
              "call_session_id"
            ],
            "outputs": [
              "qualification_flags",
              "m2_client_count",
              "coaching_eligible_flag"
            ],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "API checks primary gate: 500+ clients",
            "component": "api",
            "inputs": [
              "m2_client_count"
            ],
            "outputs": [
              "client_gate_result"
            ],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "API checks willingness to change systems confirmation",
            "component": "api",
            "inputs": [
              "qualification_flags"
            ],
            "outputs": [
              "systems_change_result"
            ],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "API checks time capacity confirmation",
            "component": "api",
            "inputs": [
              "qualification_flags"
            ],
            "outputs": [
              "time_capacity_result"
            ],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "API checks not looking for leads confirmation",
            "component": "api",
            "inputs": [
              "qualification_flags"
            ],
            "outputs": [
              "not_lead_seeking_result"
            ],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "API aggregates all gate check results",
            "component": "api",
            "inputs": [
              "all_gate_results"
            ],
            "outputs": [
              "overall_qualification_result"
            ],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Decision: All gates passed?",
            "component": "api",
            "inputs": [
              "overall_qualification_result"
            ],
            "outputs": [
              "gate_decision"
            ],
            "next_steps": [
              "STEP-010",
              "STEP-011"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "If passed: Allow M6 progression",
            "component": "api",
            "inputs": [
              "gate_decision"
            ],
            "outputs": [
              "m6_allowed_response"
            ],
            "conditions": [
              {
                "condition": "all_gates_passed",
                "outcome": "allow_m6"
              }
            ],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "If failed: Block M6, mark as advisory only",
            "component": "api",
            "inputs": [
              "gate_decision",
              "failed_gates"
            ],
            "outputs": [
              "m6_blocked_response",
              "advisory_only_flag"
            ],
            "conditions": [
              {
                "condition": "any_gate_failed",
                "outcome": "block_m6"
              }
            ],
            "next_steps": [
              "STEP-013"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "Frontend loads M6 Offer Presentation milestone",
            "component": "frontend",
            "inputs": [
              "m6_allowed_response"
            ],
            "outputs": [
              "m6_ui_loaded"
            ],
            "next_steps": []
          },
          {
            "id": "STEP-013",
            "sequence": 13,
            "action": "Frontend displays advisory-only mode, skips M6-M7",
            "component": "frontend",
            "inputs": [
              "m6_blocked_response",
              "failed_gates"
            ],
            "outputs": [
              "advisory_mode_ui_displayed"
            ],
            "next_steps": [
              "STEP-014"
            ]
          },
          {
            "id": "STEP-014",
            "sequence": 14,
            "action": "Database updates call session with advisory_only flag",
            "component": "database",
            "inputs": [
              "call_session_id",
              "advisory_only_flag"
            ],
            "outputs": [
              "session_updated"
            ],
            "next_steps": []
          }
        ],
        "data_flow": [
          {
            "from": "frontend",
            "to": "api",
            "data": "M6 progression request"
          },
          {
            "from": "api",
            "to": "database",
            "data": "Qualification data query"
          },
          {
            "from": "database",
            "to": "api",
            "data": "Qualification flags and client count"
          },
          {
            "from": "api",
            "to": "frontend",
            "data": "Gate check result (allowed/blocked)"
          },
          {
            "from": "api",
            "to": "database",
            "data": "Advisory-only flag update (if blocked)"
          }
        ],
        "error_handling": [
          {
            "error": "Client count not captured in M2",
            "response": "Return to M2 to capture client count"
          },
          {
            "error": "Qualification flags missing",
            "response": "Display warning, require flag confirmation before proceeding"
          },
          {
            "error": "Primary gate failed (under 500 clients)",
            "response": "Hard block on M6, no override allowed"
          },
          {
            "error": "Secondary gate failed",
            "response": "Soft block with manager override option (logged)"
          }
        ]
      },
      {
        "id": "SFLOW-003",
        "name": "AI Post-Call Analysis Pipeline",
        "description": "System flow that processes completed call recordings through AI analysis to generate summaries, classifications, and recommendations.",
        "components": [
          "api",
          "database",
          "queue",
          "ai_service",
          "storage"
        ],
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Call session completed with outcome classification",
            "component": "api",
            "inputs": [
              "call_session_id",
              "outcome_type",
              "recording_reference"
            ],
            "outputs": [
              "analysis_job_trigger"
            ],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "API queues AI analysis job",
            "component": "queue",
            "inputs": [
              "call_session_id",
              "recording_reference"
            ],
            "outputs": [
              "job_id",
              "job_queued"
            ],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Worker picks up analysis job",
            "component": "queue",
            "inputs": [
              "job_id"
            ],
            "outputs": [
              "job_processing"
            ],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Storage retrieves recording audio file",
            "component": "storage",
            "inputs": [
              "recording_reference"
            ],
            "outputs": [
              "audio_file"
            ],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "AI service generates transcript with speaker detection",
            "component": "ai_service",
            "inputs": [
              "audio_file"
            ],
            "outputs": [
              "transcript",
              "speaker_labels"
            ],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Database retrieves relevant AI prompts (scope: analysis)",
            "component": "database",
            "inputs": [
              "prompt_scope_analysis",
              "language"
            ],
            "outputs": [
              "analysis_prompts"
            ],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "Database retrieves call session data for context",
            "component": "database",
            "inputs": [
              "call_session_id"
            ],
            "outputs": [
              "milestone_responses",
              "objection_responses",
              "call_data"
            ],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "AI service generates call summary (factual, neutral)",
            "component": "ai_service",
            "inputs": [
              "transcript",
              "call_data",
              "summary_prompt"
            ],
            "outputs": [
              "call_summary"
            ],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "AI service classifies objections",
            "component": "ai_service",
            "inputs": [
              "transcript",
              "objection_responses",
              "classification_prompt"
            ],
            "outputs": [
              "objection_classification"
            ],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "AI service calculates decision readiness score",
            "component": "ai_service",
            "inputs": [
              "transcript",
              "milestone_responses",
              "readiness_prompt"
            ],
            "outputs": [
              "decision_readiness_score"
            ],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "AI service identifies risk flags",
            "component": "ai_service",
            "inputs": [
              "transcript",
              "risk_flags_prompt"
            ],
            "outputs": [
              "risk_flags"
            ],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "AI service generates agent execution feedback",
            "component": "ai_service",
            "inputs": [
              "transcript",
              "milestone_responses",
              "execution_prompt"
            ],
            "outputs": [
              "execution_feedback"
            ],
            "next_steps": [
              "STEP-013"
            ]
          },
          {
            "id": "STEP-013",
            "sequence": 13,
            "action": "AI service analyzes slide effectiveness signals",
            "component": "ai_service",
            "inputs": [
              "transcript",
              "slide_instances",
              "slide_analysis_prompt"
            ],
            "outputs": [
              "slide_effectiveness_signals"
            ],
            "next_steps": [
              "STEP-014"
            ]
          },
          {
            "id": "STEP-014",
            "sequence": 14,
            "action": "API validates all outputs have traceable evidence",
            "component": "api",
            "inputs": [
              "all_ai_outputs",
              "transcript"
            ],
            "outputs": [
              "evidence_links"
            ],
            "next_steps": [
              "STEP-015"
            ]
          },
          {
            "id": "STEP-015",
            "sequence": 15,
            "action": "Database creates AIAnalysis record",
            "component": "database",
            "inputs": [
              "call_session_id",
              "summary",
              "objection_classification",
              "readiness_score",
              "risk_flags",
              "execution_feedback",
              "slide_signals",
              "evidence_links"
            ],
            "outputs": [
              "ai_analysis_id"
            ],
            "next_steps": [
              "STEP-016"
            ]
          },
          {
            "id": "STEP-016",
            "sequence": 16,
            "action": "Storage saves transcript with timeline markers",
            "component": "storage",
            "inputs": [
              "call_session_id",
              "transcript",
              "timeline_markers"
            ],
            "outputs": [
              "transcript_stored"
            ],
            "next_steps": [
              "STEP-017"
            ]
          },
          {
            "id": "STEP-017",
            "sequence": 17,
            "action": "Queue marks job complete",
            "component": "queue",
            "inputs": [
              "job_id"
            ],
            "outputs": [
              "job_completed"
            ],
            "next_steps": [
              "STEP-018"
            ]
          },
          {
            "id": "STEP-018",
            "sequence": 18,
            "action": "API updates call session with analysis status",
            "component": "api",
            "inputs": [
              "call_session_id",
              "ai_analysis_id"
            ],
            "outputs": [
              "session_updated",
              "analysis_available_notification"
            ],
            "next_steps": []
          }
        ],
        "data_flow": [
          {
            "from": "api",
            "to": "queue",
            "data": "Analysis job with call_session_id"
          },
          {
            "from": "queue",
            "to": "storage",
            "data": "Recording retrieval request"
          },
          {
            "from": "storage",
            "to": "ai_service",
            "data": "Audio file for transcription"
          },
          {
            "from": "database",
            "to": "ai_service",
            "data": "Prompts and call context"
          },
          {
            "from": "ai_service",
            "to": "database",
            "data": "Analysis results"
          },
          {
            "from": "ai_service",
            "to": "storage",
            "data": "Transcript with markers"
          }
        ],
        "error_handling": [
          {
            "error": "Recording not available",
            "response": "Retry after delay, alert if persistent failure"
          },
          {
            "error": "Transcription failed",
            "response": "Log error, mark analysis as partial, allow manual transcript upload"
          },
          {
            "error": "AI service timeout",
            "response": "Retry with exponential backoff, max 3 attempts"
          },
          {
            "error": "Analysis exceeds 2-minute SLA",
            "response": "Log performance issue, complete async, notify when ready"
          },
          {
            "error": "Evidence linking failed",
            "response": "Flag outputs as unverified, allow manual review"
          }
        ]
      },
      {
        "id": "SFLOW-004",
        "name": "Slide Synchronization via WebSocket",
        "description": "System flow that maintains real-time synchronization between Rep Control Panel and Client Presentation View.",
        "components": [
          "frontend",
          "websocket_server",
          "api",
          "cache"
        ],
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Agent clicks Start Presentation Mode on Control Panel",
            "component": "frontend",
            "inputs": [
              "call_session_id",
              "slide_deck_id"
            ],
            "outputs": [
              "presentation_init_request"
            ],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "API generates unique presentation session token",
            "component": "api",
            "inputs": [
              "call_session_id",
              "agent_id"
            ],
            "outputs": [
              "presentation_token",
              "presentation_url"
            ],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Cache stores presentation session state",
            "component": "cache",
            "inputs": [
              "presentation_token",
              "initial_slide_index",
              "slide_deck_data"
            ],
            "outputs": [
              "session_cached"
            ],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Frontend opens Client Presentation View in new tab",
            "component": "frontend",
            "inputs": [
              "presentation_url"
            ],
            "outputs": [
              "presentation_tab_opened"
            ],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Control Panel establishes WebSocket connection (master)",
            "component": "websocket_server",
            "inputs": [
              "presentation_token",
              "client_type_master"
            ],
            "outputs": [
              "master_connection_established"
            ],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Presentation View establishes WebSocket connection (slave)",
            "component": "websocket_server",
            "inputs": [
              "presentation_token",
              "client_type_slave"
            ],
            "outputs": [
              "slave_connection_established"
            ],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "WebSocket server links master and slave connections",
            "component": "websocket_server",
            "inputs": [
              "master_connection",
              "slave_connection"
            ],
            "outputs": [
              "sync_channel_established"
            ],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Presentation View receives initial slide state from cache",
            "component": "cache",
            "inputs": [
              "presentation_token"
            ],
            "outputs": [
              "initial_slide_state"
            ],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Agent navigates slides on Control Panel",
            "component": "frontend",
            "inputs": [
              "navigation_action",
              "new_slide_index"
            ],
            "outputs": [
              "slide_change_event"
            ],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "Control Panel sends slide change via WebSocket",
            "component": "websocket_server",
            "inputs": [
              "slide_change_event",
              "master_connection"
            ],
            "outputs": [
              "event_received"
            ],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "WebSocket server broadcasts to slave connection",
            "component": "websocket_server",
            "inputs": [
              "slide_change_event",
              "slave_connection"
            ],
            "outputs": [
              "event_broadcast"
            ],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "Cache updates current slide state",
            "component": "cache",
            "inputs": [
              "presentation_token",
              "new_slide_index"
            ],
            "outputs": [
              "state_updated"
            ],
            "next_steps": [
              "STEP-013"
            ]
          },
          {
            "id": "STEP-013",
            "sequence": 13,
            "action": "Presentation View receives slide change event",
            "component": "frontend",
            "inputs": [
              "slide_change_event"
            ],
            "outputs": [
              "slide_update_received"
            ],
            "next_steps": [
              "STEP-014"
            ]
          },
          {
            "id": "STEP-014",
            "sequence": 14,
            "action": "Presentation View renders new slide (under 500ms)",
            "component": "frontend",
            "inputs": [
              "new_slide_index",
              "slide_data"
            ],
            "outputs": [
              "slide_rendered"
            ],
            "next_steps": [
              "STEP-015"
            ]
          },
          {
            "id": "STEP-015",
            "sequence": 15,
            "action": "Presentation View sends acknowledgment",
            "component": "websocket_server",
            "inputs": [
              "ack_event",
              "slave_connection"
            ],
            "outputs": [
              "sync_confirmed"
            ],
            "next_steps": [
              "STEP-016"
            ]
          },
          {
            "id": "STEP-016",
            "sequence": 16,
            "action": "Control Panel receives sync confirmation",
            "component": "frontend",
            "inputs": [
              "ack_event"
            ],
            "outputs": [
              "sync_status_updated"
            ],
            "next_steps": []
          }
        ],
        "data_flow": [
          {
            "from": "frontend_control",
            "to": "api",
            "data": "Presentation session request"
          },
          {
            "from": "api",
            "to": "cache",
            "data": "Session state initialization"
          },
          {
            "from": "frontend_control",
            "to": "websocket_server",
            "data": "Master connection with token"
          },
          {
            "from": "frontend_presentation",
            "to": "websocket_server",
            "data": "Slave connection with token"
          },
          {
            "from": "websocket_server",
            "to": "frontend_presentation",
            "data": "Slide change events"
          },
          {
            "from": "websocket_server",
            "to": "cache",
            "data": "State updates"
          }
        ],
        "error_handling": [
          {
            "error": "WebSocket disconnection (slave)",
            "response": "Attempt automatic reconnection, fetch current state from cache"
          },
          {
            "error": "WebSocket disconnection (master)",
            "response": "Attempt reconnection, preserve presentation in last known state"
          },
          {
            "error": "Sync latency exceeds 500ms",
            "response": "Log performance warning, continue with best effort"
          },
          {
            "error": "Presentation tab closed",
            "response": "Show reopen button on Control Panel"
          },
          {
            "error": "Cache miss on reconnect",
            "response": "Fetch full slide deck, resync from beginning"
          }
        ]
      },
      {
        "id": "SFLOW-005",
        "name": "Call Recording Pipeline",
        "description": "System flow that handles call recording via Zoom integration, from link detection to storage with timeline markers.",
        "components": [
          "frontend",
          "api",
          "zoom_integration",
          "storage",
          "database"
        ],
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Agent pastes Zoom meeting link in pre-call checklist",
            "component": "frontend",
            "inputs": [
              "zoom_link"
            ],
            "outputs": [
              "link_pasted"
            ],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "Frontend validates Zoom link format",
            "component": "frontend",
            "inputs": [
              "zoom_link"
            ],
            "outputs": [
              "link_validated"
            ],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "API receives recording activation request",
            "component": "api",
            "inputs": [
              "call_session_id",
              "zoom_link"
            ],
            "outputs": [
              "recording_request_received"
            ],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Zoom integration extracts meeting ID from link",
            "component": "zoom_integration",
            "inputs": [
              "zoom_link"
            ],
            "outputs": [
              "meeting_id"
            ],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Zoom integration initiates bot join (silent recorder)",
            "component": "zoom_integration",
            "inputs": [
              "meeting_id",
              "bot_config"
            ],
            "outputs": [
              "bot_join_initiated"
            ],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "Recording bot joins meeting within 5 seconds",
            "component": "zoom_integration",
            "inputs": [
              "meeting_id"
            ],
            "outputs": [
              "bot_joined",
              "recording_started"
            ],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "API updates call session with recording status",
            "component": "api",
            "inputs": [
              "call_session_id",
              "recording_started"
            ],
            "outputs": [
              "session_recording_active"
            ],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "Frontend displays recording indicator",
            "component": "frontend",
            "inputs": [
              "recording_status"
            ],
            "outputs": [
              "recording_indicator_shown"
            ],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Zoom integration captures audio with speaker detection",
            "component": "zoom_integration",
            "inputs": [
              "audio_stream"
            ],
            "outputs": [
              "audio_data",
              "speaker_labels"
            ],
            "next_steps": [
              "STEP-010"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "API receives milestone/objection/slide change events",
            "component": "api",
            "inputs": [
              "call_events"
            ],
            "outputs": [
              "timeline_markers"
            ],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "Timeline markers attached to recording timestamps",
            "component": "api",
            "inputs": [
              "timeline_markers",
              "recording_timestamps"
            ],
            "outputs": [
              "markers_attached"
            ],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "Call ends, agent completes outcome classification",
            "component": "frontend",
            "inputs": [
              "call_end_signal"
            ],
            "outputs": [
              "recording_stop_requested"
            ],
            "next_steps": [
              "STEP-013"
            ]
          },
          {
            "id": "STEP-013",
            "sequence": 13,
            "action": "Zoom integration stops recording",
            "component": "zoom_integration",
            "inputs": [
              "stop_signal"
            ],
            "outputs": [
              "recording_stopped",
              "final_audio_file"
            ],
            "next_steps": [
              "STEP-014"
            ]
          },
          {
            "id": "STEP-014",
            "sequence": 14,
            "action": "Recording bot leaves meeting",
            "component": "zoom_integration",
            "inputs": [],
            "outputs": [
              "bot_left"
            ],
            "next_steps": [
              "STEP-015"
            ]
          },
          {
            "id": "STEP-015",
            "sequence": 15,
            "action": "Storage receives audio file upload",
            "component": "storage",
            "inputs": [
              "audio_file",
              "call_session_id"
            ],
            "outputs": [
              "storage_reference"
            ],
            "next_steps": [
              "STEP-016"
            ]
          },
          {
            "id": "STEP-016",
            "sequence": 16,
            "action": "Storage applies encryption (AES-256)",
            "component": "storage",
            "inputs": [
              "audio_file"
            ],
            "outputs": [
              "encrypted_file"
            ],
            "next_steps": [
              "STEP-017"
            ]
          },
          {
            "id": "STEP-017",
            "sequence": 17,
            "action": "Database creates recording record with metadata",
            "component": "database",
            "inputs": [
              "call_session_id",
              "storage_reference",
              "timeline_markers",
              "duration",
              "speaker_data"
            ],
            "outputs": [
              "recording_id"
            ],
            "next_steps": [
              "STEP-018"
            ]
          },
          {
            "id": "STEP-018",
            "sequence": 18,
            "action": "Database links recording to slide instances",
            "component": "database",
            "inputs": [
              "recording_id",
              "slide_instance_ids",
              "timestamps"
            ],
            "outputs": [
              "slide_recording_links"
            ],
            "next_steps": [
              "STEP-019"
            ]
          },
          {
            "id": "STEP-019",
            "sequence": 19,
            "action": "API triggers AI analysis pipeline (SFLOW-003)",
            "component": "api",
            "inputs": [
              "call_session_id",
              "recording_id"
            ],
            "outputs": [
              "analysis_triggered"
            ],
            "next_steps": []
          }
        ],
        "data_flow": [
          {
            "from": "frontend",
            "to": "api",
            "data": "Zoom link and session ID"
          },
          {
            "from": "api",
            "to": "zoom_integration",
            "data": "Meeting join request"
          },
          {
            "from": "zoom_integration",
            "to": "storage",
            "data": "Audio file with speaker labels"
          },
          {
            "from": "api",
            "to": "database",
            "data": "Timeline markers"
          },
          {
            "from": "storage",
            "to": "database",
            "data": "Recording reference"
          }
        ],
        "error_handling": [
          {
            "error": "Invalid Zoom link",
            "response": "Display validation error, request correct link"
          },
          {
            "error": "Bot join failed",
            "response": "Retry up to 3 times, alert agent if persistent"
          },
          {
            "error": "Recording start delay exceeds 5 seconds",
            "response": "Log performance issue, continue with delayed start"
          },
          {
            "error": "Recording interrupted",
            "response": "Attempt recovery, save partial recording if unrecoverable"
          },
          {
            "error": "Storage upload failed",
            "response": "Retry with exponential backoff, alert if persistent"
          },
          {
            "error": "Meeting ended before agent",
            "response": "Detect meeting end, trigger normal recording stop flow"
          }
        ]
      },
      {
        "id": "SFLOW-006",
        "name": "GoHighLevel CRM Sync",
        "description": "System flow that synchronizes call data with GoHighLevel CRM including contact updates, pipeline stages, and calendar appointments.",
        "components": [
          "api",
          "database",
          "ghl_integration",
          "queue"
        ],
        "steps": [
          {
            "id": "STEP-001",
            "sequence": 1,
            "action": "Call session completed with outcome",
            "component": "api",
            "inputs": [
              "call_session_id",
              "outcome_type",
              "prospect_id"
            ],
            "outputs": [
              "sync_trigger"
            ],
            "next_steps": [
              "STEP-002"
            ]
          },
          {
            "id": "STEP-002",
            "sequence": 2,
            "action": "API queues CRM sync job",
            "component": "queue",
            "inputs": [
              "sync_type",
              "call_session_id",
              "prospect_id"
            ],
            "outputs": [
              "sync_job_id"
            ],
            "next_steps": [
              "STEP-003"
            ]
          },
          {
            "id": "STEP-003",
            "sequence": 3,
            "action": "Worker picks up sync job",
            "component": "queue",
            "inputs": [
              "sync_job_id"
            ],
            "outputs": [
              "job_processing"
            ],
            "next_steps": [
              "STEP-004"
            ]
          },
          {
            "id": "STEP-004",
            "sequence": 4,
            "action": "Database retrieves prospect GHL contact ID",
            "component": "database",
            "inputs": [
              "prospect_id"
            ],
            "outputs": [
              "ghl_contact_id"
            ],
            "next_steps": [
              "STEP-005"
            ]
          },
          {
            "id": "STEP-005",
            "sequence": 5,
            "action": "Database retrieves call outcome and qualification data",
            "component": "database",
            "inputs": [
              "call_session_id"
            ],
            "outputs": [
              "outcome_data",
              "qualification_flags",
              "notes"
            ],
            "next_steps": [
              "STEP-006"
            ]
          },
          {
            "id": "STEP-006",
            "sequence": 6,
            "action": "GHL integration maps outcome to pipeline stage",
            "component": "ghl_integration",
            "inputs": [
              "outcome_type"
            ],
            "outputs": [
              "pipeline_stage_id"
            ],
            "next_steps": [
              "STEP-007"
            ]
          },
          {
            "id": "STEP-007",
            "sequence": 7,
            "action": "GHL integration updates contact pipeline stage",
            "component": "ghl_integration",
            "inputs": [
              "ghl_contact_id",
              "pipeline_stage_id"
            ],
            "outputs": [
              "pipeline_update_result"
            ],
            "next_steps": [
              "STEP-008"
            ]
          },
          {
            "id": "STEP-008",
            "sequence": 8,
            "action": "GHL integration syncs contact custom fields",
            "component": "ghl_integration",
            "inputs": [
              "ghl_contact_id",
              "qualification_flags",
              "call_data"
            ],
            "outputs": [
              "contact_update_result"
            ],
            "next_steps": [
              "STEP-009"
            ]
          },
          {
            "id": "STEP-009",
            "sequence": 9,
            "action": "Check if follow-up scheduled",
            "component": "api",
            "inputs": [
              "outcome_type"
            ],
            "outputs": [
              "follow_up_check"
            ],
            "next_steps": [
              "STEP-010",
              "STEP-013"
            ]
          },
          {
            "id": "STEP-010",
            "sequence": 10,
            "action": "If follow-up: Retrieve follow-up appointment details",
            "component": "database",
            "inputs": [
              "call_session_id"
            ],
            "outputs": [
              "follow_up_datetime",
              "appointment_notes"
            ],
            "conditions": [
              {
                "condition": "outcome == follow_up_scheduled",
                "outcome": "create_appointment"
              }
            ],
            "next_steps": [
              "STEP-011"
            ]
          },
          {
            "id": "STEP-011",
            "sequence": 11,
            "action": "GHL integration creates calendar appointment",
            "component": "ghl_integration",
            "inputs": [
              "ghl_contact_id",
              "follow_up_datetime",
              "appointment_notes"
            ],
            "outputs": [
              "ghl_appointment_id"
            ],
            "next_steps": [
              "STEP-012"
            ]
          },
          {
            "id": "STEP-012",
            "sequence": 12,
            "action": "Database stores GHL appointment reference",
            "component": "database",
            "inputs": [
              "call_session_id",
              "ghl_appointment_id"
            ],
            "outputs": [
              "appointment_linked"
            ],
            "next_steps": [
              "STEP-013"
            ]
          },
          {
            "id": "STEP-013",
            "sequence": 13,
            "action": "GHL integration adds call activity note",
            "component": "ghl_integration",
            "inputs": [
              "ghl_contact_id",
              "call_summary",
              "outcome_type"
            ],
            "outputs": [
              "activity_note_created"
            ],
            "next_steps": [
              "STEP-014"
            ]
          },
          {
            "id": "STEP-014",
            "sequence": 14,
            "action": "Database logs sync completion",
            "component": "database",
            "inputs": [
              "call_session_id",
              "sync_results"
            ],
            "outputs": [
              "sync_logged"
            ],
            "next_steps": [
              "STEP-015"
            ]
          },
          {
            "id": "STEP-015",
            "sequence": 15,
            "action": "Queue marks job complete",
            "component": "queue",
            "inputs": [
              "sync_job_id"
            ],
            "outputs": [
              "job_completed"
            ],
            "next_steps": []
          }
        ],
        "data_flow": [
          {
            "from": "api",
            "to": "queue",
            "data": "Sync job with call session reference"
          },
          {
            "from": "database",
            "to": "ghl_integration",
            "data": "Contact ID and call data"
          },
          {
            "from": "ghl_integration",
            "to": "ghl_api",
            "data": "Pipeline stage update request"
          },
          {
            "from": "ghl_integration",
            "to": "ghl_api",
            "data": "Contact custom fields update"
          },
          {
            "from": "ghl_integration",
            "to": "ghl_api",
            "data": "Calendar appointment creation"
          },
          {
            "from": "ghl_integration",
            "to": "database",
            "data": "Sync result confirmation"
          }
        ],
        "error_handling": [
          {
            "error": "GHL contact not found",
            "response": "Create new contact in GHL, link to prospect"
          },
          {
            "error": "GHL API rate limit",
            "response": "Retry with exponential backoff"
          },
          {
            "error": "Pipeline stage mapping failed",
            "response": "Use default stage, log for admin review"
          },
          {
            "error": "Calendar sync failed",
            "response": "Create internal follow-up reminder, retry GHL sync"
          },
          {
            "error": "GHL authentication expired",
            "response": "Refresh OAuth token, retry request"
          },
          {
            "error": "Sync job timeout",
            "response": "Mark partial completion, queue remaining tasks"
          }
        ]
      }
    ],
    "integrations": [
      {
        "id": "INT-001",
        "name": "GoHighLevel CRM",
        "type": "CRM",
        "priority": "Phase 2",
        "description": "Primary CRM for lead management and calendar integration",
        "capabilities": [
          "Contact sync (bidirectional)",
          "Pipeline stage updates based on call outcomes",
          "Calendar sync for follow-up appointments",
          "Activity notes for call history"
        ],
        "data_exchanged": {
          "outbound": [
            "call_outcome",
            "qualification_flags",
            "follow_up_datetime",
            "call_notes"
          ],
          "inbound": [
            "contact_data",
            "qualification_form_data",
            "calendar_availability"
          ]
        },
        "authentication": "OAuth 2.0",
        "related_flows": [
          "SFLOW-006",
          "FLOW-017",
          "FLOW-021"
        ]
      },
      {
        "id": "INT-002",
        "name": "Zoom Recording API",
        "type": "Video/Recording",
        "priority": "Phase 1",
        "description": "Call recording via silent bot that joins Zoom meetings",
        "capabilities": [
          "Bot join via meeting link detection",
          "Audio recording with speaker detection",
          "Transcript generation",
          "Timeline marker attachment"
        ],
        "data_exchanged": {
          "outbound": [
            "meeting_id",
            "bot_config"
          ],
          "inbound": [
            "audio_file",
            "speaker_labels",
            "meeting_events"
          ]
        },
        "authentication": "JWT + OAuth 2.0",
        "related_flows": [
          "SFLOW-005",
          "FLOW-001",
          "FLOW-019"
        ]
      },
      {
        "id": "INT-003",
        "name": "LLM API (Claude/GPT)",
        "type": "AI Service",
        "priority": "Phase 1",
        "description": "AI-powered post-call analysis and summarization",
        "capabilities": [
          "Call summary generation",
          "Objection classification",
          "Decision readiness scoring",
          "Risk flag identification",
          "Slide effectiveness analysis",
          "Follow-up email drafting"
        ],
        "data_exchanged": {
          "outbound": [
            "transcript",
            "call_data",
            "prompts"
          ],
          "inbound": [
            "summary",
            "classifications",
            "scores",
            "recommendations"
          ]
        },
        "authentication": "API Key",
        "related_flows": [
          "SFLOW-003",
          "FLOW-019",
          "FLOW-022"
        ]
      },
      {
        "id": "INT-004",
        "name": "Nano Banana Pro",
        "type": "Visualization",
        "priority": "Phase 2",
        "description": "Dynamic slide visualization engine for presentation mode",
        "capabilities": [
          "Flow diagram generation",
          "Comparison table rendering",
          "Simple infographics",
          "Before/after schematics"
        ],
        "data_exchanged": {
          "outbound": [
            "visualization_config",
            "call_parameters"
          ],
          "inbound": [
            "rendered_visualization"
          ]
        },
        "authentication": "API Key",
        "related_flows": [
          "FLOW-024",
          "SFLOW-004"
        ]
      },
      {
        "id": "INT-005",
        "name": "WebSocket Server",
        "type": "Real-time Communication",
        "priority": "Phase 1",
        "description": "Real-time synchronization between Rep Control Panel and Client Presentation View",
        "capabilities": [
          "Bidirectional real-time messaging",
          "Connection state management",
          "Broadcast to linked clients",
          "Sub-500ms latency guarantee"
        ],
        "data_exchanged": {
          "outbound": [
            "slide_change_events",
            "sync_commands"
          ],
          "inbound": [
            "acknowledgments",
            "connection_status"
          ]
        },
        "authentication": "Session token",
        "related_flows": [
          "SFLOW-004",
          "FLOW-024"
        ]
      }
    ],
    "assumptions": [
      {
        "id": "ASMP-001",
        "category": "Technical",
        "assumption": "Sales agents have stable internet connection for Zoom calls",
        "impact": "Recording quality and WebSocket sync reliability",
        "mitigation": "Implement graceful degradation and reconnection logic",
        "related_flows": [
          "SFLOW-004",
          "SFLOW-005"
        ]
      },
      {
        "id": "ASMP-002",
        "category": "Business",
        "assumption": "Prospects are pre-qualified through EUR 495 payment gate",
        "impact": "Reduces unqualified prospect volume in the system",
        "mitigation": "System still enforces 500+ client qualification gate",
        "related_flows": [
          "FLOW-001",
          "SFLOW-002"
        ]
      },
      {
        "id": "ASMP-003",
        "category": "Business",
        "assumption": "Financial advisors/brokers understand German business context",
        "impact": "Content and terminology appropriate for target market",
        "mitigation": "Bilingual support (DE/EN) for localization",
        "related_flows": [
          "FLOW-002",
          "FLOW-003",
          "FLOW-004",
          "FLOW-005",
          "FLOW-006",
          "FLOW-007",
          "FLOW-008"
        ]
      },
      {
        "id": "ASMP-004",
        "category": "Technical",
        "assumption": "GoHighLevel is the primary CRM for lead management",
        "impact": "All CRM sync flows designed for GHL API",
        "mitigation": "Abstraction layer allows future CRM integrations",
        "related_flows": [
          "SFLOW-006",
          "FLOW-017"
        ]
      },
      {
        "id": "ASMP-005",
        "category": "Legal",
        "assumption": "Recording consent is obtained before call starts",
        "impact": "Legal compliance for call recording",
        "mitigation": "Pre-call checklist includes consent verification step",
        "related_flows": [
          "FLOW-001",
          "SFLOW-005"
        ]
      },
      {
        "id": "ASMP-006",
        "category": "Technical",
        "assumption": "Zoom API provides reliable bot join functionality",
        "impact": "Recording pipeline depends on successful bot join",
        "mitigation": "Retry logic with fallback to manual recording",
        "related_flows": [
          "SFLOW-005"
        ]
      },
      {
        "id": "ASMP-007",
        "category": "Technical",
        "assumption": "AI analysis can complete within 2 minutes post-call",
        "impact": "User experience for viewing call insights",
        "mitigation": "Async processing with notification when complete",
        "related_flows": [
          "SFLOW-003"
        ]
      },
      {
        "id": "ASMP-008",
        "category": "Business",
        "assumption": "Agents follow the diagnostic approach without persuasion",
        "impact": "Brand integrity and conversion quality",
        "mitigation": "Guardrails system blocks persuasion content at config level",
        "related_flows": [
          "FLOW-009",
          "FLOW-010",
          "FLOW-011",
          "FLOW-012",
          "FLOW-013",
          "FLOW-014",
          "FLOW-021"
        ]
      },
      {
        "id": "ASMP-009",
        "category": "Technical",
        "assumption": "Modern browser support (Chrome, Firefox, Safari, Edge - latest 2 versions)",
        "impact": "WebSocket and modern JavaScript feature availability",
        "mitigation": "Browser compatibility checks on load",
        "related_flows": [
          "SFLOW-004",
          "FLOW-024"
        ]
      },
      {
        "id": "ASMP-010",
        "category": "Business",
        "assumption": "500+ client threshold is non-negotiable for coaching eligibility",
        "impact": "Hard gate prevents override at any level",
        "mitigation": "System-enforced, no manager override possible",
        "related_flows": [
          "SFLOW-002",
          "FLOW-007"
        ]
      }
    ]
  }
}